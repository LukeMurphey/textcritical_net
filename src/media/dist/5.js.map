{"version":3,"sources":["webpack:///./src/components/Utils/index.jsx","webpack:///./src/components/URLs/BasePaths.jsx","webpack:///./src/components/URLs/index.jsx","webpack:///./src/components/Endpoints/index.js","webpack:///./src/components/URLs/Parameters.jsx","webpack:///./src/components/ErrorMessage/index.jsx","webpack:///./src/components/PopupDialog/index.jsx","webpack:///./src/components/Constants/index.js","webpack:///./src/components/WordInformation/WordLemma.css?af8a","webpack:///./src/components/WordInformation/WordLemma.css","webpack:///./src/components/PopupDialog/PopupDialog.scss?1847","webpack:///./src/components/PopupDialog/PopupDialog.scss","webpack:///./src/components/WordInformation/WordLemma.jsx","webpack:///./src/components/WordInformation/index.jsx","webpack:///./src/components/WordInformation/ExternalLookupLinks.jsx","webpack:///./src/components/WordInformation/WordInformationPopup.jsx","webpack:///./src/components/Reader/Chapter.scss?d12e","webpack:///./src/components/Reader/Chapter.scss","webpack:///./src/components/Reader/index.scss?c721","webpack:///./src/components/Reader/index.scss","webpack:///./src/components/Settings/worksList.js","webpack:///./src/components/Settings/index.js","webpack:///./src/components/Settings/fontAdjustment.js","webpack:///./src/components/AboutWorkDialog/index.jsx","webpack:///./src/components/WorkDownloadDialog/index.jsx","webpack:///./src/components/FootnotePopup/index.jsx","webpack:///./src/components/Reader/shortcuts.jsx","webpack:///./src/components/Reader/ChapterDomReplacer.jsx","webpack:///./src/components/Reader/Chapter.jsx","webpack:///./src/components/AboutDialog/index.jsx","webpack:///./src/components/Reader/NoWorkSelected.jsx","webpack:///./src/components/FavoriteWorks/WorkCard.jsx","webpack:///./src/components/FavoriteWorks/index.jsx","webpack:///./src/components/Reader/BookProgress.jsx","webpack:///./src/components/Reader/BookSidebar.jsx","webpack:///./src/components/Icons/Library.svg","webpack:///./src/components/LazyImage/index.jsx","webpack:///./src/components/BookSelection/index.jsx","webpack:///./src/components/Reader/ReadingMenuBar.jsx","webpack:///./src/components/Reader/ChapterHeader.jsx","webpack:///./src/components/Reader/StaleURLMessage.jsx","webpack:///./src/components/Reader/WarningMessages.jsx","webpack:///./src/components/Reader/index.jsx","webpack:///./src/App.jsx"],"names":["toTitleCase","str","replace","txt","charAt","toUpperCase","substr","toLowerCase","truncate","maxLength","length","substring","addHandler","handler","type","window","addEventListener","removeHandler","removeEventListener","getAbsolutePosition","element","r","x","offsetLeft","y","offsetTop","offsetParent","tmp","scrollToTarget","id","elmnt","document","getElementById","scrollIntoView","behavior","block","inline","indexOfNoDiacritic","array","word","findIndex","str1","localeCompare","undefined","sensitivity","appendLeadingQuestionMark","url","appendAmpersand","params","START_PAGE","BETA_CODE_CONVERT","READ_WORK","work","secondWork","divisionReference","divisions","divisionsFiltered","filter","entry","join","PARAMS_READ_WORK","SEARCH","q","ignoreDiacritics","searchRelatedForms","page","PARAMS_SEARCH","GOOGLE_SEARCH","PARAMS_GOOGLE_SEARCH","PERSEUS_WORD_LOOKUP","PARAMS_PERSEUS_WORD_LOOKUP","LOGEION_WORD_LOOKUP","config","getHostConfig","origin","location","hostname","ENDPOINT_READ_WORK","ENDPOINT_WORK_INFO","ENDPOINT_WORK_IMAGE","width","ENDPOINT_WORK_DOWNLOAD","format","ENDPOINT_RESOLVE_REFERENCE","reference","ENDPOINT_WORD_PARSE","ENDPOINT_WORD_FORMS","ENDPOINT_WORKS_LISTS","ENDPOINT_VERSION_INFO","ENDPOINT_SEARCH","query","relatedForms","download","pagelen","relatedFormsConverted","ignoreDiacriticsConverted","encodeURIComponent","ENDPOINT_CONVERT_BETA_CODE_QUERY","parallelWork","ErrorMessage","title","description","message","inverted","color","as","style","marginBottom","propTypes","PropTypes","string","isRequired","bool","defaultProps","getPositionRecommendation","event","clientX","innerWidth","clientY","innerHeight","PopupDialog","props","children","onClose","positionBelow","positionRight","footer","closeButtonStyle","float","cursor","marginRight","segmentStyle","position","maxHeight","overflowY","padding","zIndex","segmentStyleTinyTop","top","left","segmentStyleTinyBelow","bottom","isSmallMode","footerStyle","getContent","className","onClick","basic","height","open","func","number","MODE_LOADING","MODE_ERROR","MODE_DONE","MODE_NOT_READY","api","content","__esModule","default","module","i","options","exports","locals","___CSS_LOADER_API_IMPORT___","push","WordLemma","lexiconEntries","Message","warning","Icon","name","map","lexiconEntry","key","lemma_lexical_form","dangerouslySetInnerHTML","__html","definition","arrayOf","shape","WordInformation","searchState","useState","loading","setLoading","wordInfo","setWordInfo","error","setError","activeIndex","setActiveIndex","useEffect","fetch","then","res","json","data","e","toString","mode","ignoring_diacritics","Accordion","marginTop","fluid","index","Fragment","form","Title","active","titleProps","handleClick","lemma","meaning","Content","lexicon_entries","state","to","pathname","search","getSearchLinks","Placeholder","Header","Line","Paragraph","object","ExternalLookupLinks","target","rel","href","WordInformationDialog","storageAvailable","storage","setItem","removeItem","DOMException","code","getWorksList","storageOverride","localStorage","worksList","getItem","worksListParsed","JSON","parse","workTitleSlug","err","console","warn","getWorksLastRead","getFavoriteWorks","setFavoritesProgress","favoriteWorks","stringify","setWorkProgress","lastReadHistory","lastReadEntry","slice","splice","setFontAdjustment","adjustment","AboutWorkDialog","setData","getInfoRow","Table","Row","Cell","newData","Modal","size","defaultOpen","closeIcon","icon","scrolling","display","Image","src","celled","collapsing","Body","language","source","source_description","wiki_info","summary","image","Actions","Button","WorkDownloadDialog","setFormat","handleChange","value","stryle","Form","Field","Radio","label","checked","onChange","d","primary","FootnoteDialog","notes","note","getDivisionText","division","useTitles","descriptorsAreNames","descriptor","workSearch","queryLower","opt","text","includes","getPlaceholder","paddingTop","getDomReplaceFunction","highlightedWords","verseIdentifierPrefix","highlightedVerse","attribs","wordText","highlightIndex","domToReact","verseClassName","data-verse","data-verse-descriptor","data-original-id","Chapter","onVerseClick","onNoteClick","onWordClick","onWordHover","onClickAway","fontSizeAdjustment","clickListener","useRef","hoverListener","highlightOverridden","wrapper","createRef","current","handleClickEmpty","textContent","srcElement","handleClickWord","preventDefault","parentElement","verseDescriptorElem","Array","from","attributes","find","verseDescriptor","nodeValue","verseElem","verse","handleClickVerse","contentsElem","contents","handleClickNote","innerText","handleHover","condition","node","modify","reactElement","ref","getChapterContent","AboutDialog","serverVersionInfo","setServerVersionInfo","getInfoLinkRow","link","linkName","prefix","VersionInfo","version","build","build_date","NoWorkSelected","info","WorkCard","history","setFavoriteWork","removeFavoriteWork","titleSlug","workData","onLoadWork","workUrl","provideDropdown","Card","Responsive","minWidth","floated","maxWidth","lineHeight","overflow","textOverflow","fontWeight","work_title","Meta","division_title","Loader","extra","Group","Dropdown","textAlign","floating","trigger","Menu","Item","data-testid","withRouter","FavoriteWorks","recentlyRead","favorites","setValue","onFavWork","favoriteEntry","onUnFavWork","clearWorksLastRead","clear","itemsPerRow","clearFavorites","BookProgress","classNameSuffix","total_chapters","total_chapters_in_book","Segment","horizontal","border","completed_chapters_in_book","Math","round","progress_in_book","Progress","margin","percent","BookSidebar","sidebarVisible","openWorkInfoModal","openDownloadModal","openSearch","setSidebarVisible","Sidebar","animation","visible","onHide","vertical","LazyImage","show","setShow","Visibility","onOnScreen","ClickStyle","BookSelection","relatedWorks","onSelectWork","loadedWork","authors","works","setWorks","setSearch","searchInput","isRelatedWork","relatedWork","title_slug","loadInfo","worksData","worksToSort","sort","a","b","focus","isSameAuthor","author","searchLowerCase","onChangeDebounced","AwesomeDebouncePromise","onSearchChange","onLargeScreen","Input","placeholder","editor","workMatchesSearch","lazyLoad","isRelated","thisIsSameAuthor","isLoadedWork","paddingRight","Label","circular","empty","getWorkRow","NextPageStyle","right","PriorPageStyle","resolveReferenceDebounced","ReadingMenuBar","toggleSidebarVisible","setBookSelectionOpen","bookSelectionOpen","goToReference","openAboutModal","referenceValue","hasPriorChapter","hasNextChapter","goToPriorChapter","goToNextChapter","nextChapterDescriptor","previousChapterDescriptor","increaseFontSize","decreaseFontSize","increaseFontSizeDisabled","decreaseFontSizeDisabled","tempReferenceValue","setTempReferenceValue","referenceValid","setReferenceValid","lastSetReference","menuOpen","setMenuOpen","checkAndGoToReference","requestedWork","requestedReferenceValue","Promise","all","status","referenceInfo","preloadChapters","shiftKey","fixed","Container","Popup","on","pinned","onOpen","LibraryIcon","alt","action","disabled","onKeyPress","paddingLeft","marginLeft","direction","onBlur","ChapterHeader","onChangeChapter","chapter","parent_division","deburr","longNames","reduce","accumulator","full_title","hasLongDivisionNames","test","areDescriptorsNames","StaleURLMessage","WarningMessages","warnings","header","ContainerStyle","SidebarStyle","getWordFormsDebounced","scrollToVerse","getSecondWorkParameter","URLSearchParams","get","Reader","match","highlightRelatedForms","modal","setModal","errorDescription","setErrorDescription","setDivisions","setReferenceValue","errorTitle","setErrorTitle","errorMessage","setErrorMessage","redirectedFrom","setRedirectedFrom","redirectedTo","setRedirectedTo","setLoadedWork","setHighlightedVerse","setHighlightedWords","selectedWord","setSelectedWord","popupX","setPopupX","popupY","setPopupY","popupPositionRight","setPopupPositionRight","popupPositionBelow","setPopupPositionBelow","popupWork","setPopupWork","selectedNote","setSelectedNote","setSecondWork","secondWorkData","setSecondWorkData","secondWorkChapterNotFound","setSecondWorkChapterNotFound","secondWorkTitle","setSecondWorkTitle","parsed","parseInt","Number","isNaN","getFontAdjustment","setFontSizeAdjustment","verseReferences","setErrorState","errTitle","errDescription","errMessage","loadSecondWorkChapter","secondDivisions","reference_descriptor","updateHistory","newSecondWork","newDivisions","navigateToChapter","closeSecondWork","addVerseToHistoryList","newReferenceValue","full_descriptor","onVerseClickSecondWork","firstWorkId","firstWorkVerse","loadChapter","updatedData","newRedirectedFrom","newRedirectedTo","verse_to_highlight","wordData","forms","wordsList","previousPathname","division0","division1","division2","division3","division4","leftovers","sameSecondWork","existingChapter","highlightedVerseRef","referenceDescription","related_works","newWork","previous_chapter","next_chapter","Pushable","Pusher","closeModal","getDialogs","FootnotePopup","getPopups","Grid","Column","changeChapter","fontSize","divided","columns","App"],"mappings":"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","file":"5.bundle.js","sourcesContent":["export function toTitleCase(str) {\n  return str.replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase());\n}\n\nexport function truncate(str, maxLength) {\n    return str.length > maxLength ? `${str.substring(0, (maxLength-3))}...` : str;\n}\n\nexport function addHandler(handler, type = 'click') {\n  window.addEventListener(type, handler);\n}\n\nexport function removeHandler(handler, type = 'click') {\n  window.removeEventListener(type, handler);\n}\n\nexport function getAbsolutePosition(element) {\n  const r = { x: element.offsetLeft, y: element.offsetTop };\n  if (element.offsetParent) {\n    const tmp = getAbsolutePosition(element.offsetParent);\n    r.x += tmp.x;\n    r.y += tmp.y;\n  }\n  return r;\n};\n\nexport function scrollToTargetAdjusted(id, offset=45){\n  const element = document.getElementById(id);\n  const elementPosition = element.getBoundingClientRect().top;\n  const offsetPosition = elementPosition - offset;\n\n  window.scrollTo({\n       top: offsetPosition,\n       behavior: \"smooth\"\n  });\n}\n\nexport function scrollToTarget(id){\n  const elmnt = document.getElementById(id);\n  if(elmnt) {\n    elmnt.scrollIntoView({behavior: \"smooth\", block: \"start\", inline: \"nearest\"});\n  }\n}\n\nexport function indexOfNoDiacritic(array, word){\n  const comparer = str1 => {\n    if(str1) {\n      // Note: zero means they are equivalent\n      return str1.localeCompare(word, undefined, { sensitivity: 'base' }) === 0;\n    }\n    return false;\n  };\n\n  // const comparer = str1 => str1 === word;\n  return array.findIndex(comparer);\n}\n\n/**\n * Append a leading question mark if necessary.\n * @param {string} url \n * @returns \n */\n export function appendLeadingQuestionMark(url) {\n  return url.length === 0 ? url : `?${url}`;\n}\n\n/**\n * Append an ampersand if necessary if the URL already has at least one argument.\n * @param {*} url The URL that is going to be appended to.\n * @param {*} params The parameters that you want to append.\n * @returns The parameter with an ampersand if necessary.\n */\nexport function appendAmpersand(url, params) {\n  return url.length > 0 ? `&${params}` : params;\n}\n","/**\n * This includes the base paths for various URLs. These are broken out so that people can create references tp the paths using history where the parameters are transmitted to history.pushState via the search argument.\n */\nexport const BASE_PATH_START_PAGE = \"/\";\nexport const BASE_PATH_BETA_CODE_CONVERT = \"/beta_code_converter\";\nexport const BASE_PATH_READ_WORK = \"/work\";\nexport const BASE_PATH_SEARCH = \"/search\";\n\nexport const BASE_PATH_GOOGLE_SEARCH = \"https://www.google.com/search\";\nexport const BASE_PATH_PERSEUS_WORD_LOOKUP =\n  \"http://www.perseus.tufts.edu/hopper/morph\";\nexport const BASE_PATH_LOGEION_WORD_LOOKUP = \"https://logeion.uchicago.edu\";\n","/**\n * This page provides helper functions for creating URLs for the website.\n */\n\nimport { BASE_PATH_START_PAGE, BASE_PATH_BETA_CODE_CONVERT, BASE_PATH_READ_WORK, BASE_PATH_SEARCH, BASE_PATH_GOOGLE_SEARCH, BASE_PATH_PERSEUS_WORD_LOOKUP, BASE_PATH_LOGEION_WORD_LOOKUP } from \"./BasePaths\";\nimport { PARAMS_SEARCH, PARAMS_GOOGLE_SEARCH, PARAMS_PERSEUS_WORD_LOOKUP, PARAMS_READ_WORK } from \"./Parameters\";\n\nexport function START_PAGE() {\n  return BASE_PATH_START_PAGE;\n}\n\nexport function BETA_CODE_CONVERT() {\n  return BASE_PATH_BETA_CODE_CONVERT;\n}\n\nexport function READ_WORK(work = '', secondWork = null, ...divisions) {\n  let divisionReference = '';\n\n  const divisionsFiltered = divisions.filter((entry) => entry);\n\n  if (divisions.length > 0 && work) {\n    divisionReference = divisionsFiltered.join('/');\n    return `${BASE_PATH_READ_WORK}/${work}/${divisionReference}${PARAMS_READ_WORK(secondWork)}`;\n  }\n\n  return `${BASE_PATH_READ_WORK}/${work}`;\n}\n\nexport function SEARCH(\n  q = '',\n  ignoreDiacritics = false,\n  searchRelatedForms = false,\n  page = '',\n) {\n  return `${BASE_PATH_SEARCH}${PARAMS_SEARCH(q, ignoreDiacritics, searchRelatedForms, page)}`;\n}\n\nexport function GOOGLE_SEARCH(q = '') {\n  return `${BASE_PATH_GOOGLE_SEARCH}${PARAMS_GOOGLE_SEARCH(q)}`;\n}\n\nexport function PERSEUS_WORD_LOOKUP(word = '') {\n  return `${BASE_PATH_PERSEUS_WORD_LOOKUP}${PARAMS_PERSEUS_WORD_LOOKUP(word)}`;\n}\n\nexport function LOGEION_WORD_LOOKUP(word = '') {\n  return `${BASE_PATH_LOGEION_WORD_LOOKUP}/${word}`;\n}\n","\n/**\n * The following provides a way to map REST calls to another service (for development).\n */\n import { appendAmpersand } from '../Utils';\n \nconst config = {\n  // localhost: 'http://localhost:8080',\n};\n\n/**\n * This function determines what host to use for REST calls based on the hostname.\n * @param {*} origin The host to find the REST call domain for\n */\nexport function getHostConfig(origin = window.location.hostname) {\n  if (origin in config) {\n    return config[origin];\n  }\n\n  return '';\n}\n\nexport function ENDPOINT_READ_WORK(work = '', ...divisions) {\n\n  let divisionReference = '';\n\n  if (divisions.length > 0 && work) {\n    divisionReference = divisions.join('/');\n    return `${getHostConfig()}/api/work/${work}/${divisionReference}`;\n  }\n\n  return `${getHostConfig()}/api/work/${work}`;\n}\n\nexport function ENDPOINT_WORK_INFO(work) {\n  return `${getHostConfig()}/api/work_info/${work}`;\n}\n\nexport function ENDPOINT_WORK_IMAGE(work, width = 100) {\n  return `${getHostConfig()}/api/work_image/${work}?width=${width}`;\n}\n\nexport function ENDPOINT_WORK_DOWNLOAD(work, format = 'epub') {\n  return `${getHostConfig()}/api/download/work/${work}?format=${format}`;\n}\n\nexport function ENDPOINT_RESOLVE_REFERENCE(work, reference) {\n  return `${getHostConfig()}/api/resolve_reference/?work=${work}&ref=${reference}`;\n}\n\nexport function ENDPOINT_WIKI_INFO(search, search2 = null, search3 = null) {\n  const searchParams = [search, search2, search3].filter((e) => e != null);\n  return `${getHostConfig()}/api/wikipedia_info/${searchParams.join('/')}`;\n}\n\nexport function ENDPOINT_WORD_PARSE(word) {\n  return `${getHostConfig()}/api/word_parse/${word}`;\n}\n\nexport function ENDPOINT_WORD_FORMS(word) {\n  return `${getHostConfig()}/api/word_forms/${word}`;\n}\n\nexport function ENDPOINT_WORKS_LISTS() {\n  return `${getHostConfig()}/api/works`;\n}\n\nexport function ENDPOINT_VERSION_INFO() {\n  return `${getHostConfig()}/api/version_info`;\n}\n\nexport function ENDPOINT_SEARCH(query, page = 1, relatedForms = false, ignoreDiacritics = false, download = false, pagelen = null) {\n  let relatedFormsConverted = 0;\n  if (relatedForms) {\n    relatedFormsConverted = 1;\n  }\n\n  let ignoreDiacriticsConverted = 0;\n  if (ignoreDiacritics) {\n    ignoreDiacriticsConverted = 1;\n  }\n\n  let url = `${getHostConfig()}/api/search/${encodeURIComponent(query)}?`;\n\n  if (page) {\n    url += appendAmpersand(url, `page=${page}`);\n  }\n\n  if (pagelen) {\n    url += appendAmpersand(url, `pagelen=${pagelen}`);\n  }\n\n  url += appendAmpersand(url, `ignore_diacritics=${ignoreDiacriticsConverted}`);\n  url += appendAmpersand(url, `related_forms=${relatedFormsConverted}`);\n\n  if (download) {\n    url += appendAmpersand(url, `download=`);\n  }\n\n  return url;\n}\n\nexport function ENDPOINT_CONVERT_BETA_CODE_QUERY(query) {\n  return `${getHostConfig()}/api/convert_query_beta_code/?q=${query}`;\n}\n","/**\n * This contains the functions for making the URL parameters (that part past the ? in the URL).\n */\n\n import { appendAmpersand, appendLeadingQuestionMark } from '../Utils';\n\nexport function PARAMS_SEARCH(\n  q = \"\",\n  ignoreDiacritics = false,\n  searchRelatedForms = false,\n  page = \"\"\n) {\n  let url = \"\";\n\n  if (q) {\n    url += appendAmpersand(url, `q=${q}`);\n  }\n\n  if (page) {\n    url += appendAmpersand(url, `page=${page}`);\n  }\n\n  if (ignoreDiacritics) {\n    url += appendAmpersand(url, \"ignore_diacritics=1\");\n  }\n\n  if (searchRelatedForms) {\n    url += appendAmpersand(url, \"include_related=1\");\n  }\n\n\n  return appendLeadingQuestionMark(url)\n}\n\nexport function PARAMS_READ_WORK(\n  parallelWork = null,\n) {\n  let url = \"\";\n\n  if (parallelWork) {\n    url += appendAmpersand(url, `parallel=${parallelWork}`);\n  }\n\n  return appendLeadingQuestionMark(url)\n}\n\nexport function PARAMS_PERSEUS_WORD_LOOKUP(word = '') {\n  let url = \"\";\n\n  if (word) {\n    url += `l=${word}&la=greek`;\n  }\n\n  return appendLeadingQuestionMark(url)\n}\n\nexport function PARAMS_GOOGLE_SEARCH(q = '') {\n  let url = \"\";\n\n  if (q) {\n    url = `q=${q}`;\n  }\n\n  return appendLeadingQuestionMark(url)\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Header, Segment } from 'semantic-ui-react';\n\n/**\n * This class renders the content of chapter of a work.\n */\nfunction ErrorMessage({\n  title, description, message, inverted,\n}) {\n  return (\n    <Segment color=\"red\" inverted={inverted}>\n      <Header as=\"h3\">{title}</Header>\n      {description && (\n        description\n      )}\n      {message && description && (\n        <div style={{ marginBottom: 12 }} />\n      )}\n      { message }\n    </Segment>\n  );\n}\n\nErrorMessage.propTypes = {\n  title: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  message: PropTypes.string.isRequired,\n  inverted: PropTypes.bool,\n};\n\nErrorMessage.defaultProps = {\n  description: null,\n  inverted: false,\n};\n\nexport default ErrorMessage;\n","import React from 'react';\nimport { Segment, Icon, Portal } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport './PopupDialog.scss';\n\n/**\n * Determines a recommendation about where to show a popup.\n *\n * @param {object} event The event from the handler with the dimensions\n */\nexport const getPositionRecommendation = (event) => {\n  const positionRight = event.clientX < (window.innerWidth / 2);\n  const positionBelow = event.clientY < (window.innerHeight / 2);\n\n  return [positionRight, positionBelow];\n};\n\nconst PopupDialog = (props) => {\n  const {\n    children, onClose, x, y, positionBelow, positionRight, footer, inverted,\n  } = props;\n\n  /**\n   * This is done to get rid of the outline around the close button and get it to show up at the\n   * right of the screen.\n   */\n  const closeButtonStyle = {\n    float: 'right',\n    cursor: 'pointer',\n    marginRight: 0,\n  };\n\n  // Correct for the cases where the dialog is off of the bottom of the screen.\n  const segmentStyle = {\n    position: 'absolute',\n    width: 500,\n    maxHeight: 300,\n    overflowY: 'auto',\n    padding: 0,\n    zIndex: 103,\n  };\n\n  const segmentStyleTinyTop = {\n    ...segmentStyle,\n    ...{\n      top: 45,\n      left: 5,\n      width: 'calc(100% - 10px)',\n      position: 'fixed',\n    },\n  };\n\n  const segmentStyleTinyBelow = {\n    ...segmentStyle,\n    ...{\n      bottom: 5,\n      left: 5,\n      width: 'calc(100% - 10px)',\n      position: 'fixed',\n    },\n  };\n\n  // Determine if we ought to enter the mode for mobile devices\n  const isSmallMode = () => window.innerWidth < 1024;\n\n  // Get the style appropriate for the segment to appear\n  const getSegmentStyle = () => {\n    if (isSmallMode()) {\n      if (positionBelow) {\n        return segmentStyleTinyBelow;\n      }\n      return segmentStyleTinyTop;\n    }\n\n    return segmentStyle;\n  };\n\n  // This applies to the footer\n  const footerStyle = {\n    position: 'sticky',\n    bottom: 0,\n    width: '100%',\n  };\n\n  // Get the main content for the popup\n  const getContent = () => (\n    <Segment className=\"popupDialog\" inverted={inverted} style={getSegmentStyle()}>\n      <div style={{ padding: 15 }}>\n        <Icon style={closeButtonStyle} onClick={onClose}>&#10005;</Icon>\n        {children}\n      </div>\n      {footer && (\n        <Segment className=\"popupDialogFooter\" inverted={inverted} basic style={footerStyle}>{footer}</Segment>\n      )}\n    </Segment>\n  );\n\n  // Determine the height of the dialog\n  const height = segmentStyle.height ? segmentStyle.height : 300;\n\n  // Calculate the vertical position\n  if (positionBelow) {\n    segmentStyle.top = y;\n  } else {\n    segmentStyle.top = y - height - 20;\n  }\n\n  // Calculate the horizontal position\n  if (positionRight) {\n    segmentStyle.left = x;\n  } else {\n    segmentStyle.left = x - segmentStyle.width - 10;\n  }\n\n  // If we are running in small mode, run it as a portal so that it can appear in a fixed location\n  if (isSmallMode()) {\n    return (\n      <Portal open>\n        {getContent()}\n      </Portal>\n    );\n  }\n\n  // Otherwise, run it inline so that it is fixed in the rest of the content\n  return getContent();\n};\n\nPopupDialog.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  positionBelow: PropTypes.bool,\n  positionRight: PropTypes.bool,\n  children: PropTypes.element.isRequired,\n  footer: PropTypes.element,\n  inverted: PropTypes.bool,\n};\n\nPopupDialog.defaultProps = {\n  positionBelow: true,\n  positionRight: true,\n  footer: null,\n  inverted: false,\n};\n\nexport default PopupDialog;\n","\nexport const MODE_LOADING = 0;\nexport const MODE_ERROR = 1;\nexport const MODE_DONE = 2;\nexport const MODE_NOT_READY = 3;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./WordLemma.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".view_lexicon .speaker {\\n  font-weight: bold;\\n  display: block;\\n  margin-top: 12px;\\n}\\n.view_lexicon .milestone {\\n  color: #999999;\\n}\\n.view_lexicon [data-rend=\\\"italics\\\"] {\\n  font-style: italic;\\n}\\n.view_lexicon .milestone[data-n].milestone[data-unit]:after {\\n  font-size: smaller;\\n  margin: 3px;\\n  content: \\\"[\\\" attr(data-unit) \\\" \\\" attr(data-n) \\\"]\\\";\\n}\\n.view_lexicon .milestone[data-unit=\\\"para\\\"] {\\n  display: block;\\n  padding-top: 12px;\\n}\\n.view_lexicon .l {\\n  display: block;\\n  margin-left: 24px;\\n}\\n.view_lexicon .gap {\\n  content: \\\"...\\\";\\n}\\n.view_lexicon .quote,\\n.view_lexicon .q {\\n  font-style: italic;\\n}\\n.view_lexicon .bibl {\\n  margin-left: 3px;\\n  margin-right: 3px;\\n  font-weight: bold;\\n}\\n.view_lexicon .bibl::before {\\n  content: \\\"[\\\";\\n}\\n.view_lexicon .bibl::after {\\n  content: \\\"]\\\";\\n}\\n.view_lexicon .docauthor {\\n  display: block;\\n  padding-bottom: 16px;\\n}\\n.view_lexicon .label:not(.block) .label {\\n  margin-left: 8px;\\n  margin-right: 4px;\\n}\\n.view_lexicon .note-tag {\\n  margin-left: 4px;\\n  margin-right: 2px;\\n  cursor: hand;\\n  cursor: pointer;\\n}\\n.view_lexicon .read-more {\\n  margin-top: 16px;\\n  display: block;\\n}\\n\\n.view_lexicon .lb {\\n  display: block;\\n}\\n\\n.view_lexicon .div3 {\\n  padding-top: 16px;\\n  display: block;\\n}\\n\\n.view_lexicon .quote > .title {\\n  font-weight: bold;\\n  display: block;\\n}\\n\\n.view_lexicon .p {\\n  margin-bottom: 16px;\\n  display: block;\\n}\\n\\n.view_lexicon .lemma {\\n  text-decoration: underline;\\n  font-weight: bold;\\n}\\n\\n.view_lexicon .orth {\\n  font-weight: bold;\\n  display: block;\\n}\\n\\n.view_lexicon .etym {\\n  display: block;\\n  margin-top: 12px;\\n  font-weight: bold;\\n}\\n\\n/**\\n * Style the sense entries so that they are nested accordingly\\n */\\n.view_lexicon .sense {\\n  display: block;\\n  margin-left: 15px;\\n  margin-top: 8px;\\n}\\n\\n/**\\n * Set the margins\\n */\\n.view_lexicon .sense[data-level=\\\"2\\\"] {\\n  margin-left: 30px;\\n}\\n\\n.view_lexicon .sense[data-level=\\\"3\\\"] {\\n  margin-left: 45px;\\n}\\n\\n.view_lexicon .sense[data-level=\\\"4\\\"] {\\n  margin-left: 60px;\\n}\\n\\n.view_lexicon .sense[data-level=\\\"5\\\"] {\\n  margin-left: 75px;\\n}\\n\\n.view_lexicon .sense[data-level=\\\"6\\\"] {\\n  margin-left: 90px;\\n}\\n\\n/**\\n * Show the N indicator (\\\"1.\\\", \\\"2.\\\", etc.)\\n */\\n.view_lexicon .sense[data-level]:before {\\n  content: \\\"\\\" attr(data-n) \\\". \\\";\\n}\\n\\n.view_lexicon .sense[data-level=\\\"0\\\"]:before {\\n  content: \\\"\\\";\\n}\\n\\n/* -----------------------------------------\\n     Read work\\n     ----------------------------------------- */\\n.verse.number {\\n  font-weight: bold;\\n  color: black;\\n  /*\\n  border: white solid 1px;\\n  padding: 1px 4px 1px 4px;\\n  background-color: white;\\n  */\\n}\\n\\n.verse-container {\\n  display: inline;\\n  line-height: 25px;\\n}\\n\\n.block {\\n  display: block;\\n  margin-top: 12px;\\n}\\n\\n.no_definition_entries {\\n  font-style: italic;\\n}\\n\\n.verse .word {\\n  cursor: pointer;\\n  cursor: hand;\\n}\\n.verse .word:hover {\\n  text-decoration: underline;\\n}\\n\\n.view_lexicon .tr {\\n  font-style: italic;\\n  font-weight: bold;\\n}\\n\\n@media print {\\n  .view_lexicon .note-tag {\\n    display: none;\\n  }\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./PopupDialog.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ui.inverted.segment.popupDialog{background-color:#2B2B2E;border:1px solid #444;-webkit-box-shadow:0 15px 20px rgba(0,0,0,0.5);box-shadow:0 15px 20px rgba(0,0,0,0.5)}.popupDialog{z-index:100}.ui.inverted.segment.popupDialogFooter{border-top:1px solid #202023;background-color:#202023}.ui.segment.popupDialogFooter{border-top:1px solid #DDD;background-color:#F6F6F6}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Message, Icon } from 'semantic-ui-react';\nimport './WordLemma.css';\n\nconst WordLemma = (props) => {\n  const {\n    lexiconEntries, inverted,\n  } = props;\n\n  let className = '';\n\n  if (inverted) {\n    className = 'inverted';\n  }\n\n  return (\n    <>\n      {lexiconEntries.length === 0 && (\n        <Message warning className={className}>\n          <Icon name=\"warning\" />\n          No definition available from Liddel and Scott.\n        </Message>\n      )}\n      {lexiconEntries && (\n        lexiconEntries.map((lexiconEntry) => (\n          <div\n            key={lexiconEntry.lemma_lexical_form}\n            className=\"view_lexicon\"\n            // eslint-disable-next-line react/no-danger\n            dangerouslySetInnerHTML={{ __html: lexiconEntry.definition }}\n          />\n        ))\n      )}\n    </>\n  );\n};\n\nWordLemma.propTypes = {\n  lexiconEntries: PropTypes.arrayOf(PropTypes.shape),\n  inverted: PropTypes.bool,\n};\n\nWordLemma.defaultProps = {\n  lexiconEntries: null,\n  inverted: false,\n};\n\nexport default WordLemma;\n","import React, { useState, useEffect } from 'react';\nimport { Placeholder, Accordion, Icon } from 'semantic-ui-react';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { ENDPOINT_WORD_PARSE } from '../Endpoints';\nimport { SEARCH } from '../URLs';\nimport { PARAMS_SEARCH } from '../URLs/Parameters';\nimport ErrorMessage from '../ErrorMessage';\nimport WordLemma from './WordLemma';\nimport { MODE_LOADING, MODE_ERROR, MODE_DONE } from \"../Constants\";\n\nconst WordInformation = ({ word, inverted, work, searchState }) => {\n  const [loading, setLoading] = useState(false);\n  const [wordInfo, setWordInfo] = useState(null);\n  const [error, setError] = useState(null);\n  const [activeIndex, setActiveIndex] = useState(null);\n\n  const getSearchLinks = (state = null) => {\n    if (work) {\n      return (\n        <>\n          Search for\n          {' '}\n          {word}\n          {' '}\n          in\n          {' '}\n          <Link to={{\n            pathname: SEARCH(),\n            search: PARAMS_SEARCH(`work:${work} ${word}`),\n            state,\n            }}\n          >\n            this work\n          </Link>\n          {' '}\n          or\n          {' '}\n          <Link to={SEARCH(word)}>all works</Link>\n        </>\n      );\n    }\n    return (\n      <>\n        Search for\n        {' '}\n        <Link to={SEARCH(word)}>{word}</Link>\n      </>\n    );\n  }\n\n\n  /**\n   * Get information for the given word.\n   *\n   * @param {string} wordToLookup The word to get information on\n   */\n   const getWordInfo = () => {\n    setLoading(true);\n\n    fetch(ENDPOINT_WORD_PARSE(word))\n      .then((res) => res.json())\n      .then((data) => {\n        setWordInfo(data);\n        setLoading(false);\n        setError(null);\n        setActiveIndex(null);\n      })\n      .catch((e) => {\n        setError(e.toString());\n        setLoading(false);\n      });\n  }\n\n  useEffect(() => {\n    getWordInfo();\n  }, [word]);\n\n  const handleClick = (e, titleProps) => {\n    const { index } = titleProps;\n    const newIndex = activeIndex === index ? -1 : index;\n\n    setActiveIndex(newIndex);\n  }\n\n  let mode = MODE_LOADING;\n  if (!loading && wordInfo) {\n    mode = MODE_DONE;\n  }\n  else if (!loading && error) {\n    mode = MODE_ERROR;\n  }\n\n  return (\n    <>\n      {mode === MODE_DONE && (\n        <div>\n          Found\n          {' '}\n          {wordInfo.length}\n          {' '}\n          {wordInfo.length !== 1 && (\n            <>parses for</>\n          )}\n          {wordInfo.length === 1 && (\n            <>parse for</>\n          )}\n          {' '}\n          {word}\n          .\n          {wordInfo && wordInfo.length > 0 && wordInfo[0].ignoring_diacritics && (\n            <>\n              {' '}\n              An exact match could not be found, so similar words with different diacritical marks\n              are being returned.\n            </>\n          )}\n          <Accordion inverted={inverted} style={{ marginTop: 18 }} fluid>\n            {wordInfo.map((entry, index) => (\n              <React.Fragment key={`${entry.form}::${entry.description}`}>\n                <Accordion.Title\n                  active={activeIndex === index}\n                  index={index}\n                  onClick={(e, titleProps) => handleClick(e, titleProps)}\n                >\n                  <Icon name=\"dropdown\" />\n                  {entry.lemma}\n                  {' '}\n                  (\n                  {entry.description}\n                  ):\n                  {' '}\n                  {entry.meaning}\n                </Accordion.Title>\n                <Accordion.Content\n                  active={activeIndex === index}\n                >\n                  <WordLemma\n                    lexiconEntries={entry.lexicon_entries}\n                    inverted={inverted}\n                  />\n                </Accordion.Content>\n              </React.Fragment>\n            ))}\n          </Accordion>\n          <div style={{ marginTop: 12 }}>\n            {getSearchLinks(word, work, searchState)}\n          </div>\n        </div>\n      )}\n      {mode === MODE_ERROR && (\n        <div>\n          <ErrorMessage\n            inverted={inverted}\n            title=\"Unable to get word information\"\n            description=\"Information for the given word could not be obtained.\"\n            message={error}\n          />\n        </div>\n      )}\n      {mode === MODE_LOADING && (\n        <Placeholder inverted={inverted} style={{ marginTop: 32 }}>\n          <Placeholder.Header>\n            <Placeholder.Line />\n          </Placeholder.Header>\n          <Placeholder.Paragraph>\n            <Placeholder.Line />\n          </Placeholder.Paragraph>\n        </Placeholder>\n      )}\n    </>\n  );\n}\n\nWordInformation.propTypes = {\n  word: PropTypes.string.isRequired,\n  work: PropTypes.string,\n  inverted: PropTypes.bool,\n  // eslint-disable-next-line react/forbid-prop-types\n  searchState: PropTypes.object,\n};\n\nWordInformation.defaultProps = {\n  inverted: false,\n  work: null,\n  searchState: null,\n};\n\nexport default WordInformation;\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { GOOGLE_SEARCH, PERSEUS_WORD_LOOKUP, LOGEION_WORD_LOOKUP } from '../URLs';\n\nfunction ExternalLookupLinks({ word }) {\n  return (\n    <div>\n      Look up at\n      {' '}\n      <a target=\"_blank\" rel=\"noopener noreferrer\" href={PERSEUS_WORD_LOOKUP(word)}>\n        Perseus\n      </a>\n      ,\n      {' '}\n      <a target=\"_blank\" rel=\"noopener noreferrer\" href={LOGEION_WORD_LOOKUP(word)}>\n        Logeion\n      </a>\n      , or\n      {' '}\n      <a target=\"_blank\" rel=\"noopener noreferrer\" href={GOOGLE_SEARCH(word)}>\n        Google\n      </a>\n    </div>\n  );\n}\n\nExternalLookupLinks.propTypes = {\n  word: PropTypes.string.isRequired,\n};\n\nexport default ExternalLookupLinks;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport WordInformation from '.';\nimport PopupDialog from '../PopupDialog';\nimport ExternalLookupLinks from './ExternalLookupLinks';\n\nconst WordInformationDialog = (props) => {\n  const {\n    word, onClose, x, y, positionBelow, positionRight, inverted, work, searchState,\n  } = props;\n\n  return (\n    <PopupDialog\n      onClose={onClose}\n      inverted={inverted}\n      x={x}\n      y={y}\n      positionBelow={positionBelow}\n      positionRight={positionRight}\n      footer={<ExternalLookupLinks word={word} />}\n    >\n      <WordInformation work={work} word={word} inverted={inverted} searchState={searchState} />\n    </PopupDialog>\n  );\n};\n\nWordInformationDialog.propTypes = {\n  word: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  positionBelow: PropTypes.bool,\n  positionRight: PropTypes.bool,\n  inverted: PropTypes.bool,\n  work: PropTypes.string,\n  // eslint-disable-next-line react/forbid-prop-types\n  searchState: PropTypes.object,\n};\n\nWordInformationDialog.defaultProps = {\n  positionBelow: true,\n  positionRight: true,\n  inverted: true,\n  work: null,\n  searchState: null,\n};\n\nexport default WordInformationDialog;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./Chapter.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".view_read_work .speaker{font-weight:bold;display:block;margin-top:12px}.view_read_work .milestone{color:#999999}.view_read_work [data-rend=italics]{font-style:italic}.view_read_work .milestone[data-n].milestone[data-unit]:after{font-size:smaller;margin:3px;content:\\\"[\\\" attr(data-unit) \\\" \\\" attr(data-n) \\\"]\\\"}.view_read_work .milestone[data-unit=para]{display:block;padding-top:12px}.view_read_work .l{display:block;margin-left:24px}.view_read_work .gap{content:\\\"...\\\"}.view_read_work .quote,.view_read_work .q{font-style:italic}.view_read_work .bibl{margin-left:3px;margin-right:3px;font-weight:bold}.view_read_work .bibl::before{content:\\\"[\\\"}.view_read_work .bibl::after{content:\\\"]\\\"}.view_read_work .docauthor{display:block;padding-bottom:16px}.view_read_work .label:not(.block) .label{margin-left:8px;margin-right:4px}.view_read_work .note-tag{margin-left:4px;margin-right:2px;cursor:hand;cursor:pointer}.view_read_work .read-more{margin-top:16px;display:block}.view_read_work .lb{display:block}.view_read_work .div3{padding-top:16px;display:block}.view_read_work .quote>.title{font-weight:bold;display:block}.view_read_work .castlist:before{content:\\\"Cast list: \\\"}.view_read_work .castlist>.castitem:after{content:\\\", \\\"}.view_read_work .castlist>.castitem:last-child:after{content:\\\"\\\"}.view_read_work .argument{font-style:italic}.view_read_work .p{margin-bottom:16px;display:block}.view_read_work .lemma{text-decoration:underline;font-weight:bold}.view_read_work .orth{font-weight:bold;font-size:14pt;display:block}.view_read_work .etym{display:block;margin-top:12px;font-weight:bold}.view_read_work .sense{display:block;margin-left:32px}.view_read_work .hide{display:none}.view_read_work{font-family:\\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif}.view_read_work .icon-info-sign{font-family:\\\"Icons\\\";font-style:normal}.view_read_work .icon-info-sign:before{content:\\\"\\\\f129\\\"}.verse.number{font-weight:bold}.inverted .verse.number{color:white}.verse-container{display:inline;line-height:25px}.block{display:block;margin-top:12px}.verse-link{padding:0 4px}.verse-link:visited{color:#eee}.verse-link:active{color:#eee}.verse-link:link{color:#eee}.verse-link:hover{color:#08c}.verse-link.highlighted{background-color:red;border-radius:2px}.verse-link.highlighted .verse.number{color:white}.inverted{background-color:#2B2B2E;color:#F9F9FA}.no_definition_entries{font-style:italic}.word.highlighted,.word.searched{border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;color:white}.highlight0{background-color:#49afcd}.highlight1{background-color:#cd4949}.highlight2{background-color:#49cd5f}.highlight3{background-color:#cdcb49}.highlight4{background-color:#cd7e49}.highlight5{background-color:#c949cd}.highlight6{background-color:#cd4949}.highlight7{background-color:#49cd5f}.highlight8{background-color:#cdcb49}.highlight9{background-color:#cd7e49}.highlight10{background-color:#c949cd}.highlight11{background-color:#cd4949}.highlight12{background-color:#49cd5f}.highlight13{background-color:#cdcb49}.highlight14{background-color:#cd7e49}.highlight15{background-color:#c949cd}.highlight16{background-color:#cd4949}.highlight17{background-color:#49cd5f}.highlight18{background-color:#cdcb49}.highlight19{background-color:#cd7e49}.highlight20{background-color:#c949cd}.highlight21{background-color:#cd4949}.highlight22{background-color:#49cd5f}.highlight23{background-color:#cdcb49}.highlight24{background-color:#cd7e49}.highlight25{background-color:#c949cd}.highlight26{background-color:#cd4949}.highlight27{background-color:#49cd5f}.highlight28{background-color:#cdcb49}.highlight29{background-color:#cd7e49}.highlight30{background-color:#c949cd}.highlight31{background-color:#cd4949}.highlight32{background-color:#49cd5f}.highlight33{background-color:#cdcb49}.highlight34{background-color:#cd7e49}.highlight35{background-color:#c949cd}.highlight36{background-color:#cd4949}.highlight37{background-color:#49cd5f}.highlight38{background-color:#cdcb49}.highlight39{background-color:#cd7e49}.highlight40{background-color:#c949cd}.highlight41{background-color:#cd4949}.highlight42{background-color:#49cd5f}.highlight43{background-color:#cdcb49}.highlight44{background-color:#cd7e49}.highlight45{background-color:#c949cd}.highlight46{background-color:#cd4949}.highlight47{background-color:#49cd5f}.highlight48{background-color:#cdcb49}.highlight49{background-color:#cd7e49}.highlight50{background-color:#c949cd}.highlight51{background-color:#cd4949}.highlight52{background-color:#49cd5f}.highlight53{background-color:#cdcb49}.highlight54{background-color:#cd7e49}.highlight55{background-color:#c949cd}.word.searched{background-color:#468847}.division-2{padding-left:24px}.division-3{padding-left:48px}.division-4{padding-left:72px}.division-5{padding-left:96px}.verse .word{cursor:pointer;cursor:hand}.verse .word:hover{text-decoration:underline}@media print{.view_read_work .note-tag{display:none}}.fontSize-0{font-size:15px;line-height:1.1}.fontSize-1{font-size:17px;line-height:1.32}.fontSize-2{font-size:19px;line-height:1.54}.fontSize-3{font-size:21px;line-height:1.76}.fontSize-4{font-size:23px;line-height:1.98}.fontSize-5{font-size:25px;line-height:2.2}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"@media print{.ui.top.menu{display:none}.underMenu{margin-top:0}span,div,h1,h2,h3{color:#000 !important}div{overflow:visible !important}}@media only screen{.ui.inverted.action.input.referenceJumpInput>input{width:130px}}@media only screen and (min-width: 767px){.ui.inverted.action.input.referenceJumpInput>input{width:180px}}.underMenu{margin-top:1em}.menu.control.inverted{background-color:#202023;border-bottom:1px solid #202023}.pushable.inverted>.pusher,.pushable.inverted>.pusher,.underMenu.inverted{background-color:#2B2B2E}.otherVersions>.menu>.item>.text{margin-right:64px}.bookProgress.ui.progress>.bar,.bookProgress.ui.progress{border-radius:0}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import {LAST_READ_HISTORY, FAVORITE_WORKS} from \".\";\n\nexport function maxHistoryCount() {\n  return 6;\n}\n\nexport function storageAvailable(type) {\n  let storage;\n  try {\n    storage = window[type];\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e instanceof DOMException &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === \"QuotaExceededError\" ||\n        // Firefox\n        e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage &&\n      storage.length !== 0\n    );\n  }\n}\n\nexport function getWorksList(name, storageOverride = null) {\n  const storage = storageOverride || localStorage;\n\n  const worksList = storage.getItem(name);\n\n  if (worksList) {\n    try {\n      const worksListParsed = JSON.parse(worksList);\n\n      // Make sure that the list is an array and has the necesary properties.\n      return worksListParsed.filter((entry) => {\n        return entry.workTitleSlug;\n      });\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn(\"The list of works could not be loaded\");\n      return null; // The list could not be loaded\n    }\n  }\n\n  return null;\n}\n\nexport function getWorksLastRead(storageOverride = null) {\n  return getWorksList(LAST_READ_HISTORY, storageOverride);\n}\n\nexport function getFavoriteWorks(storageOverride = null) {\n  return getWorksList(FAVORITE_WORKS, storageOverride);\n}\n\nexport function setFavoriteWork(\n  workTitleSlug,\n  storageOverride = null\n) {\n  const storage = storageOverride || localStorage;\n\n  if (storageAvailable(\"localStorage\")) {\n    // See if the entry exists already\n    let favoriteWorks = getFavoriteWorks(storage);\n\n    // Initialize the history object if we don't have one yet\n    if (favoriteWorks === null) {\n      favoriteWorks = [];\n    }\n\n    // Find the existing index if it exists\n    const index = favoriteWorks.findIndex(\n      (entry) => entry.workTitleSlug === workTitleSlug\n    );\n\n    // Get the existing entry or initial it\n    const favoriteEntry = index >= 0 ? favoriteWorks[index] : {};\n\n    // Update the records to remove the existing entry\n    if (index >= 0) {\n      favoriteWorks = [\n        ...favoriteWorks.slice(0, index),\n        ...favoriteWorks.slice(index + 1),\n      ];\n    }\n\n    // Set the entry\n    favoriteEntry.workTitleSlug = workTitleSlug;\n\n    // Splice it in\n    favoriteWorks.splice(0, 0, favoriteEntry);\n\n    // Shorten the list to the limit\n    if (favoriteWorks.length > maxHistoryCount()) {\n      favoriteWorks = favoriteWorks.slice(0, maxHistoryCount());\n    }\n\n    // Update the history\n    storage.setItem(FAVORITE_WORKS, JSON.stringify(favoriteWorks));\n  }\n}\n\nexport function removeFavoriteWork(\n  workTitleSlug,\n  storageOverride = null\n) {\n  const storage = storageOverride || localStorage;\n\n  if (storageAvailable(\"localStorage\")) {\n    // See if the entry exists already\n    let favoriteWorks = getFavoriteWorks(storage);\n\n    const index = favoriteWorks.findIndex(\n      (entry) => entry.workTitleSlug === workTitleSlug\n    );\n\n    // Update the history to remove the existing entry\n    if (index >= 0) {\n      favoriteWorks = [\n        ...favoriteWorks.slice(0, index),\n        ...favoriteWorks.slice(index + 1),\n      ];\n\n      // Update the history\n      storage.setItem(FAVORITE_WORKS, JSON.stringify(favoriteWorks));\n    }\n  }\n}\n\nexport function setFavoritesProgress(\n  workTitleSlug,\n  divisions,\n  divisionReference,\n  storageOverride = null\n) {\n  const storage = storageOverride || localStorage;\n\n  if (storageAvailable(\"localStorage\")) {\n    // See if the entry exists in the list of favorites\n    let favoriteWorks = getFavoriteWorks(storage);\n\n    if (!favoriteWorks) {\n      favoriteWorks = [];\n    }\n\n    const index = favoriteWorks.findIndex(\n      (entry) => entry.workTitleSlug === workTitleSlug\n    );\n\n    // Update the entry if it exists\n    if (index >= 0) {\n      favoriteWorks[index].divisions = divisions;\n      favoriteWorks[index].divisionReference = divisionReference;\n\n      // Update the list\n      storage.setItem(FAVORITE_WORKS, JSON.stringify(favoriteWorks));\n    }\n  }\n}\n\nexport function setWorkProgress(\n  workTitleSlug,\n  divisions,\n  divisionReference,\n  storageOverride = null\n) {\n  const storage = storageOverride || localStorage;\n\n  if (storageAvailable(\"localStorage\")) {\n    // See if the entry exists already\n    let lastReadHistory = getWorksLastRead(storage);\n\n    // Initialize the history object if we don't have one yet\n    if (lastReadHistory === null) {\n      lastReadHistory = [];\n    }\n\n    // Find the existing index if it exists\n    const index = lastReadHistory.findIndex(\n      (entry) => entry.workTitleSlug === workTitleSlug\n    );\n\n    // Get the existing entry or initialize it\n    const lastReadEntry = index >= 0 ? lastReadHistory[index] : {};\n\n    // Update the history to remove the existing entry\n    if (index >= 0) {\n      lastReadHistory = [\n        ...lastReadHistory.slice(0, index),\n        ...lastReadHistory.slice(index + 1),\n      ];\n    }\n\n    // Set the entry\n    lastReadEntry.workTitleSlug = workTitleSlug;\n    lastReadEntry.divisions = divisions;\n    lastReadEntry.divisionReference = divisionReference;\n\n    // Splice it in\n    lastReadHistory.splice(0, 0, lastReadEntry);\n\n    // Shorten the list to the limit\n    if (lastReadHistory.length > maxHistoryCount()) {\n      lastReadHistory = lastReadHistory.slice(0, maxHistoryCount());\n    }\n\n    // Update the history\n    storage.setItem(LAST_READ_HISTORY, JSON.stringify(lastReadHistory));\n\n    setFavoritesProgress(workTitleSlug, divisions, divisionReference, storageOverride);\n  }\n}\n\nexport function clearWorksLastRead(storageOverride = null) {\n  const storage = storageOverride || localStorage;\n  storage.removeItem(LAST_READ_HISTORY);\n}\n\nexport function clearFavorites(storageOverride = null) {\n  const storage = storageOverride || localStorage;\n  storage.removeItem(FAVORITE_WORKS);\n}","// The following is the list of setting names. These need to be unique.\nexport const FONT_ADJUSTMENT = \"fontAdjustment\";\nexport const LAST_READ_HISTORY = \"lastReadHistory\";\nexport const FAVORITE_WORKS = \"favoriteWorks\";\n","import {FONT_ADJUSTMENT} from \".\";\n\nexport const MAX_FONT_SIZE_ADJUSTMENT = 4;\n\nexport function setFontAdjustment(adjustment, storageOverride = null) {\n  const storage = storageOverride || localStorage;\n  storage.setItem(FONT_ADJUSTMENT, adjustment);\n}\n\nexport function getFontAdjustment(storageOverride = null) {\n  const storage = storageOverride || localStorage;\n  const adjustment = storage.getItem(FONT_ADJUSTMENT) || 0;\n\n  if(adjustment > MAX_FONT_SIZE_ADJUSTMENT || adjustment < 0) {\n    return MAX_FONT_SIZE_ADJUSTMENT;\n  }\n\n  try {\n    const parsed = parseInt(adjustment, 10);\n    if (Number.isNaN(parsed)) {\n      return MAX_FONT_SIZE_ADJUSTMENT;\n    }\n\n    return parsed;\n  } catch (error) {\n    return MAX_FONT_SIZE_ADJUSTMENT;\n  }\n}\n\n","import React, { useState, useEffect } from 'react';\nimport {\n  Button, Header, Modal, Table, Placeholder, Image,\n} from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { ENDPOINT_WORK_INFO, ENDPOINT_WORK_IMAGE } from '../Endpoints';\nimport ErrorMessage from '../ErrorMessage';\n\n\nconst AboutWorkDialog = ({ onClose, work }) => {\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n\n  const loadInfo = () => {\n    fetch(ENDPOINT_WORK_INFO(work))\n      .then((res) => res.json())\n      .then((newData) => {\n        setData(newData);\n      })\n      .catch((e) => {\n        setError(e.toString())\n      });\n  }\n\n  const getInfoRow = (title, description) => {\n    return (\n      <Table.Row>\n        <Table.Cell>\n          <strong>{title}</strong>\n        </Table.Cell>\n        <Table.Cell>{description}</Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  useEffect(() => {\n    loadInfo(work);\n  }, []);\n\n  return (\n    <Modal size=\"small\" defaultOpen onClose={onClose} closeIcon>\n      {!data && (\n        <Header icon=\"info\" content=\"About this Book\" />\n      )}\n      {data && (\n        <Header icon=\"info\" content={`About ${data.title}`} />\n      )}\n      <Modal.Content scrolling>\n        {error && (\n          <ErrorMessage\n            title=\"Unable to load work information\"\n            description=\"Unable to get information about the work from the server\"\n            message={error}\n          />\n        )}\n        {!error && data && (\n          <>\n            <div style={{ display: 'inline-block', marginRight: 16 }}>\n              <Image style={{width: 100}} src={ENDPOINT_WORK_IMAGE(work, 400)} />\n            </div>\n            <div style={{ display: 'inline-block' }}>\n              <Table basic=\"very\" celled collapsing>\n                <Table.Body>\n                  {getInfoRow('Title', data.title)}\n                  {getInfoRow('Language', data.language)}\n                  {getInfoRow('Source', data.source)}\n                </Table.Body>\n              </Table>\n            </div>\n            <div style={{ marginTop: 16 }}>\n              {data.source_description && (\n                data.source_description\n              )}\n            </div>\n            {data.wiki_info && (\n              <div style={{ marginTop: 16 }}>\n                {data.wiki_info.summary}\n              </div>\n            )}\n          </>\n        )}\n        {!error && !data && (\n          <Placeholder>\n            <Placeholder.Header image>\n              <Placeholder.Line />\n              <Placeholder.Line />\n            </Placeholder.Header>\n            <Placeholder.Paragraph>\n              <Placeholder.Line />\n              <Placeholder.Line />\n              <Placeholder.Line />\n              <Placeholder.Line />\n            </Placeholder.Paragraph>\n          </Placeholder>\n        )}\n      </Modal.Content>\n      <Modal.Actions>\n        {data && data.wiki_info && (\n          <a target=\"_blank\" style={{ marginTop: 10, float: 'left' }} rel=\"noopener noreferrer\" href={data.wiki_info.url}>View on wikipedia</a>\n        )}\n        <Button onClick={onClose}>Close</Button>\n      </Modal.Actions>\n    </Modal>\n  );\n};\n\nAboutWorkDialog.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  work: PropTypes.string.isRequired,\n};\n\nexport default AboutWorkDialog;\n","import React, { useState } from 'react';\nimport {\n  Button, Header, Modal, Radio, Form,\n} from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { ENDPOINT_WORK_DOWNLOAD } from '../Endpoints';\n\nconst MOBI_FORMAT = 'mobi';\nconst EPUB_FORMAT = 'epub';\n\nconst WorkDownloadDialog = ({ onClose, work }) => {\n  const [format, setFormat] = useState(EPUB_FORMAT);\n\n  const download = () => {\n    document.location = ENDPOINT_WORK_DOWNLOAD(work, format);\n  }\n\n  const handleChange = (event, data) => {\n    setFormat(data.value);\n  }\n\n  return (\n    <Modal size=\"tiny\" defaultOpen onClose={onClose} closeIcon>\n      <Header icon=\"info\" content=\"Download Book\" />\n      <Modal.Content>\n        <div stryle={{ marginBottom: 12 }}>Select which format you would like to download:</div>\n        <Form>\n          <Form.Field>\n            <Radio\n              label=\"ePUB Format (Recommended)\"\n              name=\"radioGroup\"\n              value={EPUB_FORMAT}\n              checked={format === EPUB_FORMAT}\n              onChange={(e, d) => handleChange(e, d)}\n            />\n          </Form.Field>\n          <Form.Field>\n            <Radio\n              label=\"MOBI Format (Amazon Kindle)\"\n              name=\"radioGroup\"\n              value={MOBI_FORMAT}\n              checked={format === MOBI_FORMAT}\n              onChange={(e, d) => handleChange(e, d)}\n            />\n          </Form.Field>\n        </Form>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button onClick={onClose}>Close</Button>\n        <Button primary onClick={() => download()}>Download</Button>\n      </Modal.Actions>\n    </Modal>\n  );\n};\n\nWorkDownloadDialog.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  work: PropTypes.string.isRequired,\n};\n\nexport default WorkDownloadDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport PopupDialog from '../PopupDialog';\n\nconst FootnoteDialog = (props) => {\n  const {\n    notes, onClose, x, y, positionBelow, positionRight, inverted,\n  } = props;\n\n  return (\n    <PopupDialog\n      onClose={onClose}\n      inverted={inverted}\n      x={x}\n      y={y}\n      positionBelow={positionBelow}\n      positionRight={positionRight}\n    >\n      <div>\n        {notes.map((note, index) => (\n          // eslint-disable-next-line react/no-array-index-key\n          <div key={index}>{note}</div>\n        ))}\n      </div>\n    </PopupDialog>\n  );\n};\n\nFootnoteDialog.propTypes = {\n  notes: PropTypes.arrayOf(PropTypes.string).isRequired,\n  onClose: PropTypes.func.isRequired,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  positionBelow: PropTypes.bool,\n  positionRight: PropTypes.bool,\n  inverted: PropTypes.bool,\n};\n\nFootnoteDialog.defaultProps = {\n  positionBelow: true,\n  positionRight: true,\n  inverted: false,\n};\n\nexport default FootnoteDialog;\n","import React from \"react\";\nimport {\n  Placeholder,\n} from \"semantic-ui-react\";\nimport { toTitleCase } from \"../Utils\";\nimport AboutWorkDialog from \"../AboutWorkDialog\";\nimport WorkDownloadDialog from \"../WorkDownloadDialog\";\nimport WordInformation from \"../WordInformation/WordInformationPopup\";\nimport FootnotePopup from \"../FootnotePopup\";\n\n/**\n * Defines how long a division name can get before it is considered long.\n */\nconst LONG_DIVISION_NAME = 30;\n\n/**\n * Determine if the divisions tend to have long names. This is useful for determining if we ought\n * to use the titles or the shorter descriptors.\n *\n * @param {array} divisions The list of divisions.\n */\nexport function hasLongDivisionNames(divisions) {\n  const countLongNames = (accumulator, division) =>\n    division.full_title && division.full_title.length > LONG_DIVISION_NAME\n      ? accumulator + 1\n      : accumulator;\n  const longNames = divisions.reduce(countLongNames, 0);\n\n  return longNames > 5 || longNames === divisions.length;\n}\n\n/**\n * Determine if the division descriptors appear to be names.\n *\n * @param {array} divisions The list of divisions.\n */\nexport function areDescriptorsNames(divisions) {\n  const countIndicators = (accumulator, division) =>\n    /^([0-9]+|[IVX]+|[A-Z])$/i.test(division.descriptor)\n      ? accumulator + 1\n      : accumulator;\n  const indicators = divisions.reduce(countIndicators, 0);\n  return indicators !== divisions.length;\n}\n\n/**\n * Get the the division descriptor.\n *\n * @param {array} division The list of divisions.\n * @param {*} useTitles Whether titles ought to be used.\n * @param {*} descriptorsAreNames Whether descriptors appear to be names.\n */\nexport function getDivisionText(division, useTitles, descriptorsAreNames) {\n  // Use the title (from the full_title of the division)\n  if (useTitles) {\n    return toTitleCase(division.label);\n  }\n  // Are the descriptors names (like \"Matthew\" insread of \"1\")\n  if (descriptorsAreNames) {\n    return division.descriptor;\n  }\n  return `${division.type} ${division.descriptor}`;\n}\n\n/**\n * Convert the list of divisions to options that can be processed by the dropdown menu.\n *\n * @param {array} divisions The list of divisions.\n */\nexport function convertDivisionsToOptions(divisions) {\n  const useTitles = !hasLongDivisionNames(divisions);\n  const descriptorsAreNames = areDescriptorsNames(divisions);\n\n  return divisions.map((d) => ({\n    key: d.description,\n    text: getDivisionText(d, useTitles, descriptorsAreNames),\n    value: d.descriptor,\n  }));\n}\n\n/**\n * This function looks for the chapter the user entered. It looks both in the description as well\n * as the key.\n * This is useful because the works often use a Greek name as the description but an English\n * description too and we want both to be searchable (don't want users to have to type Μαρκον).\n * @param {array} options List of dropdown options\n * @param {string} query The string that the user entered that we are searching for\n */\nexport function workSearch(options, query) {\n  const queryLower = query.toLowerCase();\n  return options.filter(\n    (opt) =>\n      opt.text.toLowerCase().includes(queryLower) ||\n      opt.key.toLowerCase().includes(queryLower)\n  );\n}\n\n/**\n * Get a placeholder for the content.\n */\nexport function getPlaceholder(inverted = false) {\n  return (\n    <div style={{ paddingTop: 16 }}>\n      <Placeholder inverted={inverted}>\n        <Placeholder.Header>\n          <Placeholder.Line />\n        </Placeholder.Header>\n        <Placeholder.Paragraph>\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n        </Placeholder.Paragraph>\n        <Placeholder.Paragraph>\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n        </Placeholder.Paragraph>\n        <Placeholder.Paragraph>\n          <Placeholder.Line />\n          <Placeholder.Line />\n          <Placeholder.Line />\n        </Placeholder.Paragraph>\n      </Placeholder>\n    </div>\n  );\n}\n\n/**\n * Get the dialogs that ought to be rendered.\n */\nexport function getDialogs(modal, data, loading, loadedWork, closeModal) {\n  return (\n    <>\n      {data && !loading && modal === \"aboutWork\" && (\n        <AboutWorkDialog\n          work={loadedWork}\n          onClose={() => closeModal()}\n        />\n      )}\n      {data && !loading && modal === \"downloadWork\" && (\n        <WorkDownloadDialog\n          work={loadedWork}\n          onClose={() => closeModal()}\n        />\n      )}\n    </>\n  );\n}\n\nexport const MODAL_WORD = \"word\";\nexport const MODAL_FOOTNOTE = \"note\";\n\n/**\n * Get the popups.\n */\nexport function getPopups(modal,\n  data,\n  loading,\n  selectedWord,\n  popupX,\n  popupY,\n  popupPositionRight,\n  popupPositionBelow,\n  selectedNote,\n  loadedWork,\n  closeModal,\n  searchState,\n  inverted,) {\n\n  return (\n    <>\n      {data && !loading && modal === MODAL_WORD && (\n        <WordInformation\n          inverted={inverted}\n          positionBelow={popupPositionBelow}\n          positionRight={popupPositionRight}\n          x={popupX}\n          y={popupY}\n          word={selectedWord}\n          work={loadedWork}\n          onClose={() => closeModal()}\n          searchState={searchState}\n        />\n      )}\n      {data && !loading && modal === MODAL_FOOTNOTE && (\n        <FootnotePopup\n          inverted={inverted}\n          positionBelow={popupPositionBelow}\n          positionRight={popupPositionRight}\n          x={popupX}\n          y={popupY}\n          notes={selectedNote}\n          onClose={() => closeModal()}\n        />\n      )}\n    </>\n  );\n}\n\n/**\n* Get the text for the node separated into lines.\n*\n* @param {object} element The element to get the text from\n*/\nexport function getText(element) {\n try {\n   const children = [];\n\n   // If the node is text, then add the line\n   if (element.nodeType === 3) {\n     if (element.textContent && element.textContent.length > 0) {\n       children.push(element.textContent);\n     }\n   }\n\n   // Accumulate the children entries\n   const childEntries = Array.from(element.childNodes).reduce(\n     (accum, child) => accum.concat(...this.getText(child)),\n     [],\n   );\n\n   children.push(...childEntries);\n\n   // Return the content\n   if (children) {\n     return children;\n   }\n } catch (err) {\n   // If an exception happens, then just use the text content\n   return [element.textContent];\n }\n\n return [element.textContent];\n}\n","/* eslint-disable react/prop-types */\nimport { domToReact } from \"html-react-parser\";\nimport React from 'react';\nimport { indexOfNoDiacritic } from \"../Utils\";\n\nconst getDomReplaceFunction = (\n  highlightedWords,\n  verseIdentifierPrefix,\n  highlightedVerse\n) => {\n  return ({ attribs, children }) => {\n    // Handle highlighted words\n    if (\n      attribs &&\n      attribs.class === \"word\" &&\n      highlightedWords &&\n      children.length > 0 &&\n      children[0].type === \"text\"\n    ) {\n      // Get the value of the word\n      const wordText = children[0].data;\n\n      // Get the index of the highlighted word\n      const highlightIndex = indexOfNoDiacritic(highlightedWords, wordText);\n\n      // Add the highlight tag if we have a match\n      if (highlightIndex >= 0) {\n        return (\n          <span className={`word highlighted highlight${highlightIndex}`}>\n            {domToReact(children)}\n          </span>\n        );\n      }\n    }\n\n    // Stop if this isn't a verse\n    if (!attribs || !(\"data-verse\" in attribs)) return undefined;\n\n    const verseClassName =\n      attribs && attribs[\"data-verse\"] === highlightedVerse\n        ? \"verse-link highlighted\"\n        : \"verse-link\";\n\n    return (\n      <a\n        className={verseClassName}\n        href={attribs.href}\n        data-verse={attribs[\"data-verse\"]}\n        data-verse-descriptor={attribs[\"data-verse-descriptor\"]}\n        data-original-id={attribs.id}\n        id={`${verseIdentifierPrefix}${attribs.id}`}\n      >\n        {domToReact(children)}\n      </a>\n    );\n  };\n};\n\nexport default getDomReplaceFunction;\n","import React, { createRef, useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport parse from 'html-react-parser';\nimport getDomReplaceFunction from './ChapterDomReplacer';\nimport { getPositionRecommendation } from '../PopupDialog';\nimport { getAbsolutePosition } from '../Utils';\nimport './Chapter.scss';\n\n/**\n * This class renders the content of chapter of a work.\n *\n * render() is going to parse some HTML it gets from the server and then present it.\n * The reason is that the works are persisted in a preformatted state in order to improve\n * performance. The alternative is to parse the XML on the client-side and process it into\n * HTML. This would mean that the content could not be cached. Right now, the server pre-processes\n * the content into HTML chunks and then caches so that it can be loaded quickly.\n */\nconst Chapter = ( {content, highlightedVerse, onVerseClick, onNoteClick, onWordClick, onWordHover, onClickAway, highlightedWords, fontSizeAdjustment, verseIdentifierPrefix, inverted} ) => {\n\n    // We need to track the event listener with the bind call so that it can be removed\n    // See https://dev.to/em4nl/function-identity-in-javascript-or-how-to-remove-event-listeners-properly-1ll3\n  const clickListener = useRef(null);\n  const hoverListener = useRef(null);\n\n  // We need to track when a verse was selected for highlight\n  const highlightOverridden = useRef(false);\n\n  // We are keeping a reference to the wrapper so that math can be done regarding client rectangle\n  // See https://medium.com/trabe/getting-rid-of-finddomnode-method-in-your-react-application-a0d7093b2660\n  const wrapper = createRef();\n\n  /**\n   * Get the chapter content\n   * @param {string} className The class name to put the content under\n   */\n   const getChapterContent = (className) =>{\n\n    // These options will process the nodes such that the node gets a tag indicating that it is\n    // highlighted\n    const options = {\n      // eslint-disable-next-line react/prop-types\n      replace: getDomReplaceFunction(highlightedWords, verseIdentifierPrefix, highlightedVerse),\n      condition: (node) => node.className.toLowerCase() === 'word',\n      modify: (node) => {\n        // eslint-disable-next-line no-param-reassign\n        node.className += ' highlighted';\n        return node;\n      },\n    };\n\n    const reactElement = parse(content, options);\n\n    return (\n      <div\n        className={`${className} fontSize-${fontSizeAdjustment}`}\n        ref={wrapper}\n      >\n        {reactElement}\n      </div>\n    );\n  }\n\n  const addHandler = (handler, type = 'click') =>{\n    if (wrapper.current) {\n      wrapper.current.addEventListener(type, (event) => handler(event));\n    }\n  }\n\n  const removeHandler = (handler, type = 'click') =>{\n    if (wrapper.current) {\n      wrapper.current.removeEventListener(type, (event) => handler(event));\n    }\n  }\n\n  /**\n   * Handle the clicking of a word.\n   *\n   * @param {*} event The event object\n   */\n  const handleClickWord = (event) => {\n    const word = event.target.textContent;\n\n    const [positionRight, positionBelow] = getPositionRecommendation(event);\n    const {x , y} = getAbsolutePosition(event.srcElement);\n    onWordClick(word, x, y, positionRight, positionBelow);\n  }\n\n  /**\n   * Handle the clicking of a verse.\n   *\n   * @param {*} event The event object\n   */\n  const handleClickVerse = (event) => {\n    // Don't follow the link\n    event.preventDefault();\n\n    // Get the target containing the verse info\n    const target = event.target.parentElement;\n\n    // Get the descriptor of the verse\n    const verseDescriptorElem = Array.from(target.attributes).find((element) => element.name === 'data-verse-descriptor');\n    const verseDescriptor = verseDescriptorElem ? verseDescriptorElem.nodeValue : null;\n\n    // Get the ID\n    const { id } = target;\n\n    // Get the the href\n    let href;\n\n    if (target.attributes.href) {\n      href = target.attributes.href.nodeValue;\n    } else {\n      href = null;\n    }\n\n    // Get the verse number\n    const verseElem = Array.from(target.attributes).find((element) => element.name === 'data-verse');\n    const verse = verseElem ? verseElem.nodeValue : null;\n\n    // Stop if we didn't get what we needed to continue\n    if (!verseDescriptor) {\n      return;\n    }\n\n    highlightOverridden.current = true;\n\n    // Fire off the handler\n    const {x , y} = getAbsolutePosition(event.srcElement);\n    onVerseClick(verseDescriptor, verse, id, href, x, y);\n  }\n\n  /**\n   * handle the clicking of a note.\n   */\n  const handleClickNote = (event) => {\n    // Get the ID\n    const { id } = event.target;\n\n    // Get the contents for the given ID\n    const contentsElem = document.getElementById(`content_for_${id}`);\n    let contents = ['Note content could not be found'];\n\n    if (contentsElem) {\n      contents = [contentsElem.textContent];\n    }\n\n    const [positionRight, positionBelow] = getPositionRecommendation(event);\n\n    // Fire off the handler\n    const {x , y} = getAbsolutePosition(event.srcElement);\n    onNoteClick(contents, id, x, y, positionRight, positionBelow);\n  }\n\n  const handleClickEmpty = () =>{\n    onClickAway();\n  }\n\n  const handleClick = (event) => {\n    // Determine if we are clicking a word, verse, note, or just empty space\n    if (event.target.className.includes('word')) {\n      handleClickWord(event);\n    } else if (event.target.className.includes('verse')) {\n      handleClickVerse(event);\n      handleClickEmpty();\n    } else if (event.target.className.includes('note-tag')) {\n      handleClickNote(event);\n    } else {\n      handleClickEmpty();\n    }\n  }\n\n  /**\n   * Handle the case where the user has hovered over a word.\n   * @param {*} event \n   */\n  const handleHover = (event) => {\n    if (event.target.className.includes('word')) {\n      onWordHover(event.target.innerText);\n    }\n    else {\n      onWordHover(null);\n    }\n  }\n\n  useEffect(() => {\n    /**\n    * Wire up handlers for the clicking of the words and verses.\n    */\n    clickListener.current = (event) => handleClick(event);\n    addHandler(clickListener.current);\n\n    hoverListener.current = (event) => handleHover(event);\n    addHandler(hoverListener.current, 'mousemove');\n\n    /**\n     * Un wire the handlers to save memory.\n     */\n    return function cleanup() {\n      removeHandler(clickListener.current);\n      removeHandler(hoverListener.current, 'mousemove');\n    };\n  }, []);\n\n\n  // Determine the class name\n  let className = 'view_read_work';\n\n  if (inverted) {\n    className = 'view_read_work inverted';\n  }\n\n  return (\n    <>\n      {getChapterContent(className)}\n    </>\n  );\n};\n\nChapter.propTypes = {\n  content: PropTypes.string.isRequired,\n  highlightedVerse: PropTypes.string,\n  highlightedWords: PropTypes.arrayOf(PropTypes.string),\n  onVerseClick: PropTypes.func,\n  onWordClick: PropTypes.func,\n  onClickAway: PropTypes.func,\n  onNoteClick: PropTypes.func,\n  onWordHover: PropTypes.func,\n  inverted: PropTypes.bool,\n  verseIdentifierPrefix: PropTypes.string,\n  fontSizeAdjustment: PropTypes.number,\n};\n\nChapter.defaultProps = {\n  highlightedVerse: null,\n  highlightedWords: null,\n  onVerseClick: () => { },\n  onWordClick: () => { },\n  onClickAway: () => { },\n  onNoteClick: () => { },\n  onWordHover: () => { },\n  inverted: false,\n  verseIdentifierPrefix: '',\n  fontSizeAdjustment: 0,\n};\n\nexport default Chapter;\n","import React, { useState, useEffect } from 'react';\nimport {\n  Button, Header, Modal, Table, Placeholder,\n} from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { ENDPOINT_VERSION_INFO } from \"../Endpoints\";\nimport VersionInfo from '../../Version.json'\n\nconst AboutDialog = ({ onClose }) => {\n\n  const [serverVersionInfo, setServerVersionInfo] = useState(null);\n  const [error, setError] = useState(null);\n\n  const getServerVersionInfo = () => {\n    fetch(ENDPOINT_VERSION_INFO())\n      .then((res) => res.json())\n      .then((newData) => {\n        setServerVersionInfo(newData);\n      })\n      .catch((e) => {\n        setError(e.toString());\n      });\n  };\n\n  useEffect(() => {\n    getServerVersionInfo();\n  }, []);\n\n  const getInfoRow = (title, description) => {\n    return (\n      <Table.Row>\n        <Table.Cell>\n          <strong>{title}</strong>\n        </Table.Cell>\n        <Table.Cell>{description}</Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  const getInfoLinkRow = (title, link, linkName, prefix = '') => {\n    return (\n      <Table.Row>\n        <Table.Cell>\n          <strong>{title}</strong>\n        </Table.Cell>\n        <Table.Cell>\n          {prefix}\n          <a target=\"_blank\" rel=\"noopener noreferrer\" href={link}>\n            {linkName}\n          </a>\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  return (\n    <Modal defaultOpen onClose={onClose} closeIcon>\n      <Header icon=\"info\" content=\"About TextCritical.net\" />\n      <Modal.Content>\n        <p>\n          TextCritical.net is a website that provides ancient Greek texts and\n          useful analysis tools.\n        </p>\n        <Table basic=\"very\" celled collapsing>\n          <Table.Body>\n            {getInfoRow('Version', VersionInfo.version)}\n            {serverVersionInfo && getInfoRow('Server Version', `${serverVersionInfo.version}, ${serverVersionInfo.build} (${serverVersionInfo.build_date})`)}\n            {!serverVersionInfo && !error && getInfoRow('Server Version', (<Placeholder><Placeholder.Line /></Placeholder>))}\n            {error && getInfoRow('Server Version', 'Unable to get server version information')}\n            {getInfoLinkRow(\n              'Sources of the works',\n              'https://lukemurphey.net/projects/ancient-text-reader/wiki/Content_Sources',\n              'LukeMurphey.net',\n              'Available at ',\n            )}\n            {getInfoLinkRow(\n              'Source Code',\n              'https://github.com/LukeMurphey/textcritical_net',\n              'Github.com',\n              'Available at ',\n            )}\n            {getInfoLinkRow(\n              'Components used',\n              'https://lukemurphey.net/projects/ancient-text-reader/wiki/Dependencies',\n              'LukeMurphey.net',\n              'Available at ',\n            )}\n          </Table.Body>\n        </Table>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button onClick={onClose}>Close</Button>\n      </Modal.Actions>\n    </Modal>\n  );\n};\n\nAboutDialog.propTypes = {\n  onClose: PropTypes.func.isRequired,\n};\n\nexport default AboutDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Message, Button } from 'semantic-ui-react';\n\nconst NoWorkSelected = ({ inverted, onClick }) => (\n  <Message info className={inverted ? 'inverted' : ''}>\n    <Message.Header>No Book Selected</Message.Header>\n    <p>\n      Choose a book above to begin reading.\n    </p>\n    {onClick && (\n      <p>\n        <Button onClick={() => onClick()} inverted={inverted}>Open Library</Button>\n      </p>\n    )}\n  </Message>\n);\n\nNoWorkSelected.propTypes = {\n  onClick: PropTypes.func,\n  inverted: PropTypes.bool,\n};\n\nNoWorkSelected.defaultProps = {\n  inverted: false,\n  onClick: null,\n};\n\nexport default NoWorkSelected;\n","import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Card, Image, Button, Loader, Icon, Dropdown, Responsive } from \"semantic-ui-react\";\nimport { withRouter } from \"react-router-dom\";\nimport { ENDPOINT_RESOLVE_REFERENCE, ENDPOINT_WORK_IMAGE } from \"../Endpoints\";\nimport { MODE_LOADING, MODE_ERROR, MODE_DONE } from \"../Constants\";\nimport { READ_WORK } from \"../URLs\";\nimport { truncate } from \"../Utils\";\n\nconst WorkCard = ({\n  inverted,\n  work,\n  divisions,\n  divisionReference,\n  history,\n  setFavoriteWork,\n  removeFavoriteWork,\n}) => {\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n\n  const loadInfo = (titleSlug) => {\n    fetch(ENDPOINT_RESOLVE_REFERENCE(titleSlug, divisionReference))\n      .then((res) => res.json())\n      .then((workData) => {\n        setData(workData);\n      })\n      .catch((e) => {\n        setError(e.toString());\n      });\n  };\n\n  useEffect(() => {\n    if (!data && !error) loadInfo(work);\n  });\n\n  const onLoadWork = () => {\n    // Get the URL\n    const workUrl = READ_WORK(work, null, ...divisions);\n    history.push(workUrl);\n  };\n\n  // Determine the mode\n  let mode = MODE_LOADING;\n\n  if (error) {\n    mode = MODE_ERROR;\n  } else if (data) {\n    mode = MODE_DONE;\n  }\n\n  // Determine the classname\n  const className = inverted ? 'inverted' : '';\n\n  // Determine if we have options\n  const provideDropdown = removeFavoriteWork || setFavoriteWork;\n\n  return (\n    <Card className={className}>\n      <Card.Content style={{cursor:'pointer'}} onClick={onLoadWork}>\n        <Responsive minWidth={992}>\n          <Image floated=\"right\" size=\"mini\" src={ENDPOINT_WORK_IMAGE(work)} />\n        </Responsive>\n        <Responsive maxWidth={992}>\n          <Image size=\"small\" src={ENDPOINT_WORK_IMAGE(work, 200)} />\n        </Responsive>\n        {mode === MODE_DONE && (\n          <Responsive minWidth={992}>\n            <Card.Header\n              style={{\n                lineHeight: \"1.2em\",\n                maxHeight: \"2.4em\",\n                overflow: \"hidden\",\n                textOverflow: \"ellipsis\",\n                color: 'black',\n                fontWeight: 'bold'\n              }}\n            >\n              {truncate(data.work_title, 20)}\n            </Card.Header>\n            <Card.Meta>{data.division_title}</Card.Meta>\n          </Responsive>\n        )}\n        {mode === MODE_LOADING && <Loader active />}\n        {mode === MODE_ERROR && (\n          <Icon color=\"red\" name=\"attention\" size=\"large\" title={error} />\n        )}\n      </Card.Content>\n      <Card.Content extra>\n        <div className=\"ui two buttons\">\n          {provideDropdown && (\n            <>\n              <Button.Group fluid color='green'>\n                <Responsive minWidth={992}>\n                  <Button color='green' onClick={onLoadWork}>\n                    Read\n                  </Button>\n                </Responsive>\n                <Dropdown\n                  style={{textAlign: 'center'}}\n                  className='button icon'\n                  floating\n                  trigger={<></>}\n                >\n                  <Dropdown.Menu>\n                    {setFavoriteWork && (\n                      <Dropdown.Item icon='heart' data-testid=\"setFav\" text='Set as favorite' onClick={() => setFavoriteWork(work)} />\n                    )}\n                    {removeFavoriteWork && (\n                      <Dropdown.Item icon='remove' data-testid=\"removeFav\" text='Remove from favorites' onClick={() => removeFavoriteWork(work)} />\n                    )}\n                  </Dropdown.Menu>\n                </Dropdown>\n              </Button.Group>\n            </>\n          )}\n          {!provideDropdown && (\n          <Button basic color=\"green\" onClick={onLoadWork}>\n            Read\n          </Button>\n          )}\n        </div>\n      </Card.Content>\n    </Card>\n  );\n};\n\nWorkCard.propTypes = {\n  inverted: PropTypes.bool,\n  work: PropTypes.string.isRequired,\n  divisionReference: PropTypes.string,\n  divisions: PropTypes.arrayOf(PropTypes.string),\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  setFavoriteWork: PropTypes.func,\n  removeFavoriteWork: PropTypes.func,\n};\n\nWorkCard.defaultProps = {\n  inverted: false,\n  divisionReference: null,\n  divisions: [],\n  setFavoriteWork: null,\n  removeFavoriteWork: null,\n};\n\nexport default withRouter(WorkCard);\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Card, Header, Button } from \"semantic-ui-react\";\nimport {\n  getWorksLastRead,\n  maxHistoryCount,\n  clearWorksLastRead,\n  getFavoriteWorks,\n  clearFavorites,\n  setFavoriteWork,\n  removeFavoriteWork,\n} from \"../Settings/worksList\";\nimport WorkCard from \"./WorkCard\";\n\nconst FavoriteWorks = ({ inverted }) => {\n  const recentlyRead = getWorksLastRead();\n  const favorites = getFavoriteWorks();\n  const [value, setValue] = useState(0); // Using an integer as a state marker to get the view to rerender when necessary\n\n  const onFavWork = work => {\n    setFavoriteWork(work);\n    setValue(value + 1)\n  }\n\n  const onUnFavWork = work => {\n    removeFavoriteWork(work);\n    setValue(value + 1)\n  }\n\n  return (\n    <div>\n      {((recentlyRead && recentlyRead.length > 0) || value > 0) && (\n        <>\n          <Header inverted={inverted} as=\"h3\">\n            Most Recently Read\n            {recentlyRead && recentlyRead.length > 0 && (\n              <Button\n                floated=\"right\"\n                onClick={() => {\n                  clearWorksLastRead();\n                  setValue(value + 1);\n                }}\n              >\n                Clear this list\n              </Button>\n              )}\n          </Header>\n          {recentlyRead && recentlyRead.length > 0 && (\n          <Card.Group style={{clear: 'both'}} itemsPerRow={maxHistoryCount()}>\n            {recentlyRead.map((work) => (\n              <WorkCard\n                key={work.workTitleSlug}\n                work={work.workTitleSlug}\n                divisions={work.divisions}\n                divisionReference={work.divisionReference}\n                setFavoriteWork={onFavWork}\n              />\n            ))}\n          </Card.Group>\n          )}\n          {(!recentlyRead || recentlyRead.length === 0) && value > 0 && (\n            <>No works in the list of recently read works</>\n          )}\n        </>\n      )}\n\n      {((favorites && favorites.length > 0) || value > 0) && (\n        <>\n          <Header inverted={inverted} as=\"h3\">\n            Favorites\n            {favorites && favorites.length > 0 && (\n            <Button\n              floated=\"right\"\n              onClick={() => {\n                clearFavorites();\n                setValue(value + 1);\n              }}\n            >\n              Clear this list\n            </Button>\n            )}\n          </Header>\n          {favorites && favorites.length > 0 && (\n          <Card.Group style={{clear: 'both'}} itemsPerRow={maxHistoryCount()}>\n            {favorites.map((work) => (\n              <WorkCard\n                key={work.workTitleSlug}\n                work={work.workTitleSlug}\n                divisions={work.divisions}\n                divisionReference={work.divisionReference}\n                removeFavoriteWork={onUnFavWork}\n              />\n            ))}\n          </Card.Group>\n          )}\n          {(!favorites || favorites.length === 0) && value > 0 && (\n            <>No favorited works</>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nFavoriteWorks.propTypes = {\n  inverted: PropTypes.bool,\n};\n\nFavoriteWorks.defaultProps = {\n  inverted: false,\n};\n\nexport default FavoriteWorks;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Segment, Progress } from 'semantic-ui-react';\n\nconst BookProgress = ({ data, inverted }) => {\n\n    // Create a custom className for signaling the desire to switch to inverted\n    let classNameSuffix = \"\";\n\n    if (inverted) {\n      classNameSuffix = \" inverted\";\n    }\n\n    return (\n      <>\n        { data && data.total_chapters > 1 && data.total_chapters_in_book > 1 && (\n          <>\n            <Segment.Group\n              horizontal\n              style={{ border: 0, marginBottom: 4 }}\n              className={`${classNameSuffix}`}\n            >\n              <Segment basic inverted style={{ padding: 0 }}>\n                {data.completed_chapters_in_book}\n                {' '}\n                of\n                {\" \"}\n                {data.total_chapters_in_book}\n                {' '}\n                chapters\n                {\" \"}\n              </Segment>\n              <Segment\n                basic\n                inverted\n                style={{ textAlign: \"right\", padding: 0 }}\n              >\n                {Math.round(data.progress_in_book)}\n                % through the book\n              </Segment>\n            </Segment.Group>\n            <Progress\n              className=\"bookProgress\"\n              color=\"blue\"\n              style={{ margin: \"0 0 8px 0\" }}\n              percent={data.progress_in_book}\n              size=\"tiny\"\n            />\n          </>\n        )}\n      </>\n)};\n\nBookProgress.propTypes = {\n  data: PropTypes.shape({\n    progress_in_book: PropTypes.number,\n    total_chapters_in_book: PropTypes.number,\n    completed_chapters_in_book: PropTypes.number,\n    total_chapters: PropTypes.number,\n}),\n  inverted: PropTypes.bool,\n};\n\nBookProgress.defaultProps = {\n  inverted: false,\n  data: null,\n};\n\nexport default BookProgress;\n","import React from 'react';\nimport { Sidebar, Image, Menu } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport {\n  ENDPOINT_WORK_IMAGE,\n} from \"../Endpoints\";\n\nconst BookSidebar = ({ sidebarVisible, work, openWorkInfoModal, openDownloadModal, openSearch, setSidebarVisible }) => {\n  return (\n    <Sidebar\n      as={Menu}\n      animation=\"overlay\"\n      icon=\"labeled\"\n      style={{ width: 200, paddingTop: 50 }}\n      inverted\n      visible={sidebarVisible}\n      onHide={() => setSidebarVisible(false)}\n      vertical\n      width=\"thin\"\n    >\n      <Image src={ENDPOINT_WORK_IMAGE(work, 400)} />\n      <Menu.Item as=\"a\" onClick={() => openWorkInfoModal()}>\n        Information\n      </Menu.Item>\n      <Menu.Item as=\"a\" onClick={() => openDownloadModal()}>\n        Download\n      </Menu.Item>\n      <Menu.Item as=\"a\" onClick={() => openSearch()}>\n        Search\n      </Menu.Item>\n    </Sidebar>\n  )\n}\n\nBookSidebar.propTypes = {\n  sidebarVisible: PropTypes.bool.isRequired,\n  work: PropTypes.string.isRequired,\n  openWorkInfoModal: PropTypes.func.isRequired,\n  openDownloadModal: PropTypes.func.isRequired,\n  openSearch: PropTypes.func.isRequired,\n  setSidebarVisible: PropTypes.func.isRequired,\n}\n\nexport default BookSidebar;\n","export default __webpack_public_path__ + \"images/5a0a1a6aa2a65b08197971f38a43cf6c-Library.svg\";","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Visibility, Image, Loader } from 'semantic-ui-react';\n\nconst LazyImage = ({size, children, src, style}) => {\n  const [show, setShow] = useState(false);\n\n  if (!show) {\n    return (\n      <Visibility as=\"span\" onOnScreen={() => setShow(true)}>\n        {children && children}\n        {!children && <Loader data-testid=\"loader\" active inline=\"centered\" size={size} />}\n      </Visibility>\n    );\n  }\n  \n  return <Image style={style} src={src} />;\n};\n\nLazyImage.propTypes = {\n  src: PropTypes.string.isRequired,\n  size: PropTypes.string,\n  children: PropTypes.element,\n  // eslint-disable-next-line react/forbid-prop-types\n  style: PropTypes.object,\n};\n\nLazyImage.defaultProps = {\n  size: 'tiny',\n  children: null,\n  style: {},\n};\n\nexport default LazyImage;\n","import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Table, Placeholder, Image, Input, Label,\n} from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\n// regeneratorRuntime is needed for AwesomeDebouncePromise\n// eslint-disable-next-line no-unused-vars\nimport regeneratorRuntime from 'regenerator-runtime';\nimport AwesomeDebouncePromise from 'awesome-debounce-promise';\nimport { ENDPOINT_WORKS_LISTS, ENDPOINT_WORK_IMAGE } from '../Endpoints';\nimport LazyImage from '../LazyImage';\nimport ErrorMessage from '../ErrorMessage';\n\nconst ClickStyle = {\n  cursor: 'pointer',\n};\n\nconst workMatchesSearch = (work, search) => {\n  return work.title.toLowerCase().includes(search)\n  || work.title_slug.toLowerCase().includes(search)\n  || work.author.toLowerCase().includes(search)\n  || work.editor.toLowerCase().includes(search)\n  || work.language.toLowerCase().includes(search);\n}\n\nconst BookSelection = ({ relatedWorks, onSelectWork, loadedWork, authors }) => {\n\n  const [works, setWorks] = useState(null);\n  const [error, setError] = useState(null);\n  const [search, setSearch] = useState('');\n  const searchInput = useRef(null);\n\n  const onSearchChange = (data) => {\n    setSearch(data.value);\n  }\n\n  /**\n   * Determine if the work is a related work.\n   *\n   * @param {object} work The work to see if it is a related work\n   */\n   const isRelatedWork = (work) => {\n    const found = relatedWorks.find((relatedWork) => relatedWork.title_slug === work.title_slug);\n    if (found) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Sort the list of works.\n   *\n   * @param {array} works The works to sort\n   */\n  const sortWorks = (worksToSort) => {\n    worksToSort.sort((a, b) => {\n      if (isRelatedWork(a) && !isRelatedWork(b)) {\n        return -1;\n      }\n      if (isRelatedWork(b) && !isRelatedWork(a)) {\n        return 1;\n      }\n      return a.title > b.title;\n    });\n\n    return worksToSort;\n  }\n\n  /**\n   * Load the list of works from the server.\n   */\n  const loadInfo = () => {\n    fetch(ENDPOINT_WORKS_LISTS())\n      .then((res) => res.json())\n      .then((worksData) => {\n        setWorks(sortWorks(worksData));\n        searchInput.current.focus();\n      })\n      .catch((e) => {\n        setError(e.toString());\n      });\n  }\n\n  /**\n   * Determine if the work is by the same author\n   *\n   * @param {object} work The work to see if it is a related work\n   */\n   const isSameAuthor = (work) => {\n    if (!authors || !work.author) {\n      return false;\n    }\n\n    const found = authors.find((author) => author.name === work.author);\n\n    if (found) {\n      return true;\n    }\n\n    return false;\n  }\n\n  const getWorkRow = (work, lazyLoad = true, onLargeScreen = true) => {\n    const handler = () => { onSelectWork(work.title_slug); };\n    const isRelated = isRelatedWork(work);\n    const thisIsSameAuthor = isSameAuthor(work);\n    const isLoadedWork = (loadedWork && loadedWork === work.title_slug);\n\n    return (\n      <Table.Row key={work.title_slug}>\n        { onLargeScreen && (\n          <Table.Cell className=\"workImage\" style={ClickStyle} onClick={handler}>\n            { lazyLoad && (\n              <LazyImage style={{ width: 32 }} src={ENDPOINT_WORK_IMAGE(work.title_slug, 64)}>\n                <Image style={{ width: 32 }} src=\"/book-cover-small.png\" />\n              </LazyImage>\n            )}\n            { !lazyLoad && (\n              <Image style={{ width: 32 }} src={ENDPOINT_WORK_IMAGE(work.title_slug, 64)} />\n            )}\n          </Table.Cell>\n        )}\n        <Table.Cell style={ClickStyle} onClick={handler}>\n          <div>\n            {work.title}\n            <div style={{ display: 'inline-block', float: 'right', paddingRight: 4 }}>\n              {isRelated && onLargeScreen && (\n                <Label as=\"a\" color=\"red\">Related Work</Label>\n              )}\n              {thisIsSameAuthor && !isLoadedWork && onLargeScreen && (\n                <Label as=\"a\" color=\"blue\">Same Author</Label>\n              )}\n              {isLoadedWork && onLargeScreen && (\n                <Label as=\"a\" color=\"green\">This work</Label>\n              )}\n              {isRelated && !onLargeScreen && (\n                <Label as=\"a\" color=\"red\" circular empty />\n              )}\n              {thisIsSameAuthor && !isLoadedWork && !onLargeScreen && (\n                <Label as=\"a\" color=\"blue\" circular empty />\n              )}\n            </div>\n          </div>\n          <div style={{ color: '#888' }}>\n            {work.language}\n            {work.author && ` by ${work.author}`}\n            {work.editor && ` (${work.editor})`}\n          </div>\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  const searchLowerCase = search.toLowerCase();\n\n  const onChange = (event, data) => { onSearchChange(data); };\n  const onChangeDebounced = AwesomeDebouncePromise(onChange, 500);\n\n  const onLargeScreen = window.innerWidth > 767;\n\n  // Change the width on small screens\n  const width = onLargeScreen ? 500 : 250;\n\n  useEffect(() => {\n    loadInfo();\n  }, []);\n\n  return (\n    <>\n      {!error && works && (\n        <div>\n          <Input\n            ref={searchInput}\n            onChange={onChangeDebounced}\n            style={{ width: \"100%\" }}\n            placeholder=\"Search...\"\n          />\n        </div>\n      )}\n      <div style={{ maxHeight: 400, width, overflowY: \"auto\" }}>\n        {error && (\n          <ErrorMessage\n            title=\"Unable to load the list of works\"\n            description=\"Unable to get the list of works from the server\"\n            message={error}\n          />\n        )}\n        {!error && works && (\n          <Table basic=\"very\" celled collapsing>\n            <Table.Body>\n              {works\n                .filter((work) =>\n                  workMatchesSearch(work, searchLowerCase)\n                )\n                .map((work, index) =>\n                  getWorkRow(work, index > 15, onLargeScreen)\n                )}\n            </Table.Body>\n          </Table>\n        )}\n        {!error && !works && (\n          <Placeholder>\n            <Placeholder.Paragraph>\n              <Placeholder.Line />\n              <Placeholder.Line />\n              <Placeholder.Line />\n            </Placeholder.Paragraph>\n          </Placeholder>\n        )}\n      </div>\n    </>\n  );\n}\n\nBookSelection.propTypes = {\n  onSelectWork: PropTypes.func.isRequired,\n  relatedWorks: PropTypes.arrayOf(PropTypes.shape),\n  authors: PropTypes.arrayOf(PropTypes.string),\n  loadedWork: PropTypes.string,\n};\n\nBookSelection.defaultProps = {\n  relatedWorks: [],\n  authors: [],\n  loadedWork: null,\n};\n\nexport default BookSelection;\n","import React, { useState, useEffect, useRef } from 'react';\nimport { Menu, Container, Icon, Popup, Input, Button, Responsive, Dropdown } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from \"react-router-dom\";\nimport AwesomeDebouncePromise from \"awesome-debounce-promise\";\nimport { START_PAGE, BETA_CODE_CONVERT, SEARCH } from \"../URLs\";\nimport LibraryIcon from \"../Icons/Library.svg\";\nimport BookSelection from '../BookSelection';\nimport { addHandler, removeHandler } from '../Utils';\nimport {\n  ENDPOINT_RESOLVE_REFERENCE,\n  ENDPOINT_READ_WORK\n} from \"../Endpoints\";\n\nconst NextPageStyle = {\n  bottom: \"20px\",\n  right: \"20px\",\n  position: \"fixed\",\n};\n\nconst PriorPageStyle = {\n  bottom: \"20px\",\n  left: \"20px\",\n  position: \"fixed\",\n};\n\nconst resolveReferenceDebounced = AwesomeDebouncePromise(\n  (titleSlug, reference) =>\n    fetch(ENDPOINT_RESOLVE_REFERENCE(titleSlug, reference)),\n  500\n);\n\nconst ReadingMenuBar = ({\n  inverted,\n  toggleSidebarVisible,\n  loadedWork,\n  relatedWorks,\n  authors,\n  onSelectWork,\n  setBookSelectionOpen,\n  bookSelectionOpen,\n  goToReference,\n  openAboutModal,\n  referenceValue,\n  history,\n  hasPriorChapter,\n  hasNextChapter,\n  goToPriorChapter,\n  goToNextChapter,\n  nextChapterDescriptor,\n  previousChapterDescriptor,\n  increaseFontSize,\n  decreaseFontSize,\n  increaseFontSizeDisabled,\n  decreaseFontSizeDisabled,\n }) => {\n  // Create a custom className for signaling the desire to switch to inverted\n  let classNameSuffix = \"\";\n\n  if (inverted) {\n    classNameSuffix = \" inverted\";\n  }\n\n  // The temp reference value represents the local value of the reference that has not yet been\n  // sent up to the caller.\n  const [ tempReferenceValue, setTempReferenceValue ] = useState(null);\n\n  // Indicates if the reference is valid\n  const [ referenceValid, setReferenceValid ] = useState(true);\n\n  // Indicates we got an error somewhere\n  const [ error, setError ] = useState(null);\n\n  // This will store the last reference set so that we make sure not to replace the reference\n  // we did a reference resolution check against the server for.\n  const lastSetReference = useRef(null);\n\n  const [ menuOpen, setMenuOpen ] = useState(false);\n  \n  /**\n   * Go to the reference defined in the input box but only if it is valid.\n   */\n  const checkAndGoToReference = (requestedWork, requestedReferenceValue) => {\n    // Stop if we have no where to go\n    if (!requestedWork || !requestedReferenceValue) {\n      return;\n    }\n\n    // Verify the reference is valid before going to it\n    fetch(ENDPOINT_RESOLVE_REFERENCE(requestedWork, requestedReferenceValue))\n      .then((res) => Promise.all([res.status, res.json()]))\n      .then(([status, referenceInfo]) => {\n        if (status === 200) {\n          goToReference(requestedWork, requestedReferenceValue, referenceInfo);\n        }\n      })\n  }\n\n    /**\n     * Accept the enter key as a jumop to execute the reference jump.\n     * @param {object} event The event from the key press.\n     */\n    const onKeyPressed = (event) => {\n      if (event.key === \"Enter\") {\n        setTempReferenceValue(null);\n        checkAndGoToReference(loadedWork, tempReferenceValue || referenceValue);\n      }\n    }\n\n    /**\n     * Handle a change in the reference input.\n     *\n     * @param {*} event React's original SyntheticEvent.\n     * @param {*} info All props.\n     */\n    const changeReference = (event, info) => {\n      // Stop if we have nothing to lookup\n      if (!loadedWork || !info.value) {\n        return;\n      }\n\n      setTempReferenceValue(info.value);\n      setReferenceValid(true);\n      setError(null);\n\n      // Store this entry so that we can avoid updating the reference if the user entered another\n      // reference before the server's response came back\n      lastSetReference.current = info.value;\n\n      resolveReferenceDebounced(loadedWork, info.value)\n        .then((res)  => {\n          // If the user already changed the value again, just ignore it\n          if (lastSetReference.current !== info.value) {\n            return;\n          }\n\n          if (res.status === 200) {\n            setTempReferenceValue(info.value);\n            setReferenceValid(true);\n          } else {\n            setTempReferenceValue(info.value);\n            setReferenceValid(false);\n          }\n        })\n        .catch((e) => {\n          setError(e.toString());\n        });\n    }\n\n  /**\n   * Preload the next chapter.\n   */\n  const preloadNextChapter = () => {\n    if (nextChapterDescriptor) {\n      fetch(\n        ENDPOINT_READ_WORK(`${loadedWork}/${nextChapterDescriptor}`)\n      );\n    }\n  }\n\n  /**\n   * Preload the prior chapter.\n   */\n  const preloadPriorChapter = () => {\n    if (previousChapterDescriptor) {\n      fetch(\n        ENDPOINT_READ_WORK(\n          `${loadedWork}/${previousChapterDescriptor}`\n        )\n      );\n    }\n  }\n\n    /**\n     * Preload the next and prior chapter\n     */\n    const preloadChapters = () => {\n      preloadNextChapter();\n      preloadPriorChapter();\n    }\n\n    /**\n     * Open the start page.\n     */\n    const openStartPage = () => {\n      history.push(START_PAGE());\n      setMenuOpen(false);\n    }\n\n    /**\n     * Increase font size.\n     */\n    const clickIncreaseFontSize = () => {\n      if(increaseFontSize){\n        increaseFontSize();\n      }\n    }\n\n    /**\n     * Decrease font size.\n     */\n    const clickDecreaseFontSize = () => {\n      if(decreaseFontSize){\n        decreaseFontSize();\n      }\n    }\n\n    /**\n     * Open the beta-code conversion page.\n     */\n    const openBetaCodePage = () => {\n      history.push(BETA_CODE_CONVERT());\n      setMenuOpen(false);\n    }\n\n    /**\n     * Open the search page.\n     */\n    const openSearchPage = () => {\n      history.push(SEARCH());\n      setMenuOpen(false);\n    }\n\n    /**\n     * Clear the overriding reference value when the caller changes it.\n     * This is necessary when the caller has changed to another page and we need to show the we\n     * navigated.\n     */\n    useEffect(() => {\n      setTempReferenceValue(null);\n    }, [referenceValue]);\n\n    /**\n     * Preload the pages when we get new data.\n     */\n    useEffect(() => {\n      preloadChapters();\n    }, [nextChapterDescriptor, previousChapterDescriptor]);\n    \n    /**\n     * Handle key presses\n     */\n    const upHandler = ({ key, shiftKey }) => {\n      if (key === 'ArrowRight' && shiftKey) {\n        if(goToNextChapter) {\n          goToNextChapter();\n        }\n      }\n  \n      if (key === 'ArrowLeft' && shiftKey) {\n        if(goToPriorChapter) {\n          goToPriorChapter();\n        }\n      }\n    };\n\n    // Wire-up the handlers for the key presses\n    const handler = (event) => upHandler(event);\n    useEffect(() => {\n      addHandler(handler, 'keyup');\n      return () => removeHandler(handler, 'keyup');\n    });\n\n    return (\n      <Menu\n        inverted={inverted}\n        style={{ zIndex: 103 }}\n        className={`control ${classNameSuffix}`}\n        fixed=\"top\"\n      >\n        <Container>\n          {loadedWork && (\n          <Menu.Item\n            name=\"works\"\n            onClick={() => toggleSidebarVisible()}\n          >\n            <Icon name=\"bars\" />\n          </Menu.Item>\n        )}\n          <Popup\n            content={(\n              <BookSelection\n                relatedWorks={relatedWorks}\n                authors={authors}\n                onSelectWork={(work) => onSelectWork(work)}\n                loadedWork={loadedWork}\n              />\n          )}\n            on=\"click\"\n            position=\"bottom left\"\n            pinned\n            onClose={() => setBookSelectionOpen(false)}\n            onOpen={() => setBookSelectionOpen(true)}\n            open={bookSelectionOpen}\n            trigger={(\n              <Menu.Item name=\"Library\">\n                <img style={{ width: 16 }} src={LibraryIcon} alt=\"Library\" />\n              </Menu.Item>\n          )}\n          />\n          {loadedWork && (\n          <Menu.Item>\n            <Input\n              inverted={inverted}\n              className=\"referenceJumpInput\"\n              action={(\n                <Button\n                  disabled={!referenceValid}\n                  inverted={inverted}\n                  onClick={() => {\n                    setTempReferenceValue(null);\n                    checkAndGoToReference(loadedWork, tempReferenceValue || referenceValue);\n                  }}\n                  basic\n                >\n                  Go\n                </Button>\n              )}\n              placeholder=\"Jump to reference...\"\n              value={tempReferenceValue || referenceValue || ''}\n              error={!referenceValid}\n              onChange={(e, d) => changeReference(e, d)}\n              onKeyPress={(e, d) => onKeyPressed(e, d)}\n            />\n            {error && (<Popup inverted={inverted} content={error} trigger={<Icon style={{paddingLeft: 8}} color=\"red\" name=\"warning sign\" />} />)}\n          </Menu.Item>\n        )}\n          <div style={{ float: \"right\", marginLeft: \"auto\", marginTop: 11 }}>\n            <Responsive minWidth={768}>\n              <Dropdown icon=\"ellipsis vertical\" direction=\"left\" open={menuOpen} onClick={() => setMenuOpen(true)} onBlur={() => setMenuOpen(false)}>\n                <Dropdown.Menu>\n                  {(increaseFontSize || decreaseFontSize) && (\n                    <>\n                      <span style={{color: 'rgba(0, 0, 0, 0.87)', marginLeft: 18, marginRight: 12}}>Font size:</span>\n                      <Button.Group>\n                        {increaseFontSize && (\n                          <Button icon=\"plus\" disabled={increaseFontSizeDisabled} onClick={() => clickIncreaseFontSize()} />\n                        )}\n                        {decreaseFontSize && (\n                          <Button icon=\"minus\" disabled={decreaseFontSizeDisabled} onClick={() => clickDecreaseFontSize()} />\n                        )}\n                      </Button.Group>\n                      \n                    </>\n                  )}\n                  <Dropdown.Item\n                    text=\"Go to Start Page\"\n                    onClick={() => openStartPage()}\n                  />\n                  <Dropdown.Item\n                    text=\"Search\"\n                    onClick={() => openSearchPage()}\n                  />\n                  <Dropdown.Item\n                    text=\"Look up Greek words (and convert beta-code)\"\n                    onClick={() => openBetaCodePage()}\n                  />\n                  <Dropdown.Item\n                    text=\"About TextCritical.net\"\n                    onClick={() => {\n                      setMenuOpen(false);\n                      openAboutModal();\n                    }}\n                  />\n                </Dropdown.Menu>\n              </Dropdown>\n            </Responsive>\n          </div>\n        </Container>\n        {loadedWork && goToPriorChapter && goToNextChapter && (\n        <>\n          <Button\n            icon\n            inverted={inverted}\n            style={PriorPageStyle}\n            className={`priorPage ${classNameSuffix}`}\n            disabled={!hasPriorChapter}\n            onClick={() => goToPriorChapter()}\n            title=\"Go to prior chapter (or use shortcut shift + left arrow)\"\n          >\n            <Icon name=\"left chevron\" />\n          </Button>\n          <Button\n            icon\n            inverted={inverted}\n            style={NextPageStyle}\n            className={`nextPage ${classNameSuffix}`}\n            disabled={!hasNextChapter}\n            onClick={() => goToNextChapter()}\n            title=\"Go to next chapter (or use shortcut shift + right arrow)\"\n          >\n            <Icon name=\"right chevron\" />\n          </Button>\n        </>\n      )}\n      </Menu>\n    )\n};\n\nReadingMenuBar.propTypes = {\n  inverted: PropTypes.bool.isRequired,\n  relatedWorks: PropTypes.arrayOf(PropTypes.shape),\n  authors: PropTypes.arrayOf(PropTypes.string),\n  loadedWork: PropTypes.string,\n  toggleSidebarVisible: PropTypes.func.isRequired,\n  onSelectWork: PropTypes.func.isRequired,\n  setBookSelectionOpen: PropTypes.func.isRequired,\n  bookSelectionOpen: PropTypes.bool,\n  goToReference: PropTypes.func.isRequired,\n  openAboutModal: PropTypes.func.isRequired,\n  goToPriorChapter: PropTypes.func,\n  goToNextChapter: PropTypes.func,\n  increaseFontSize: PropTypes.func,\n  decreaseFontSize: PropTypes.func,\n  referenceValue: PropTypes.string,\n  hasNextChapter: PropTypes.bool,\n  hasPriorChapter: PropTypes.bool,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  nextChapterDescriptor: PropTypes.string,\n  previousChapterDescriptor: PropTypes.string,\n  increaseFontSizeDisabled: PropTypes.bool,\n  decreaseFontSizeDisabled: PropTypes.bool,\n}\n\nReadingMenuBar.defaultProps = {\n  referenceValue: '',\n  authors: [],\n  relatedWorks: [],\n  loadedWork: null,\n  bookSelectionOpen: false,\n  hasNextChapter: false,\n  hasPriorChapter: false,\n  goToPriorChapter: null,\n  goToNextChapter: null,\n  increaseFontSize: null,\n  decreaseFontSize: null,\n  nextChapterDescriptor: null,\n  previousChapterDescriptor: null,\n  increaseFontSizeDisabled: true,\n  decreaseFontSizeDisabled: true,\n}\n\nexport default withRouter(ReadingMenuBar);\n","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport {Dropdown,\n  Header,\n} from \"semantic-ui-react\";\nimport { convertDivisionsToOptions, workSearch }  from \"./shortcuts\";\n\nconst ChapterHeader = ({ inverted, data, onChangeChapter }) => {\n  return (\n    <Header inverted={inverted} floated=\"left\" as=\"h3\">\n      {data.chapter.parent_division && (\n      <>\n        <Dropdown\n          inline\n          floating\n          deburr\n          scrolling\n          search={workSearch}\n          options={convertDivisionsToOptions(\n              data.divisions\n            )}\n          value={data.chapter.parent_division.descriptor}\n          onChange={(event, info) =>\n            onChangeChapter(event, info)}\n        />\n        <div\n          style={{\n              display: \"inline-block\",\n              paddingLeft: 6,\n            }}\n        >\n          {data.chapter.type}\n          {` ${data.chapter.descriptor}`}\n        </div>\n      </>\n      )}\n    </Header>\n  )\n};\n\n\nChapterHeader.propTypes = {\n  data: PropTypes.shape({\n      chapter: PropTypes.shape({\n        descriptor: PropTypes.string,\n        type: PropTypes.string,\n        parent_division: PropTypes.shape({\n          descriptor: PropTypes.string,\n        }),\n      }),\n      divisions: PropTypes.arrayOf(PropTypes.shape({\n        description: PropTypes.string,\n        type: PropTypes.string,\n        label: PropTypes.string,\n      }))\n  }),\n  onChangeChapter: PropTypes.func,\n  inverted: PropTypes.bool,\n}\n\nChapterHeader.defaultProps = {\n  data: null,\n  onChangeChapter: null,\n  inverted: false,\n}\n\nexport default ChapterHeader;\n","import React from 'react';\nimport { Message } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\n\nconst StaleURLMessage = ({ inverted }) => {\n\n  // Create a custom className for signaling the desire to switch to inverted\n  let classNameSuffix = \"\";\n\n  if (inverted) {\n    classNameSuffix = \" inverted\";\n  }\n\n  return (\n    <Message info className={classNameSuffix}>\n      <p>\n        The URL you were using was old so you were redirected to\n        the new one. You may want to update your shortcuts.\n      </p>\n    </Message>\n  );\n};\n\nStaleURLMessage.propTypes = {\n  inverted: PropTypes.bool,\n};\n\nStaleURLMessage.defaultProps = {\n  inverted: false,\n};\n\nexport default StaleURLMessage;\n","import React from 'react';\nimport { Message } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\n\nconst WarningMessages = ({ inverted, warnings }) => {\n\n  // Create a custom className for signaling the desire to switch to inverted\n  let classNameSuffix = \"\";\n\n  if (inverted) {\n    classNameSuffix = \" inverted\";\n  }\n\n  return (\n    <>\n      { warnings.map((warning) => (\n        <Message\n          className={classNameSuffix}\n          warning\n          key={warning[0]}\n          header={warning[0]}\n          content={warning[1]}\n        />\n      ))}\n    </>\n  )};\n\n  WarningMessages.propTypes = {\n    inverted: PropTypes.bool,\n    warnings: PropTypes.arrayOf(\n      PropTypes.string,\n      PropTypes.string,\n    ).isRequired,\n  };\n  \n  WarningMessages.defaultProps = {\n    inverted: false,\n  };\n  \n  export default WarningMessages;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { Container, Header, Grid, Segment, Sidebar, Icon } from \"semantic-ui-react\";\nimport { withRouter } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport AwesomeDebouncePromise from 'awesome-debounce-promise';\nimport { ENDPOINT_READ_WORK, ENDPOINT_WORD_FORMS } from \"../Endpoints\";\nimport { setWorkProgress } from \"../Settings/worksList\";\nimport { setFontAdjustment, getFontAdjustment, MAX_FONT_SIZE_ADJUSTMENT } from \"../Settings/fontAdjustment\";\nimport { SEARCH, READ_WORK } from \"../URLs\";\nimport { PARAMS_READ_WORK } from \"../URLs/Parameters\";\nimport { getPlaceholder, getDialogs, getPopups, MODAL_WORD, MODAL_FOOTNOTE }  from \"./shortcuts\";\nimport { scrollToTarget } from '../Utils';\nimport Chapter from \"./Chapter\";\nimport ErrorMessage from \"../ErrorMessage\";\nimport AboutDialog from \"../AboutDialog\";\nimport NoWorkSelected from \"./NoWorkSelected\";\nimport \"./index.scss\";\nimport FavoriteWorks from \"../FavoriteWorks\";\nimport BookProgress from \"./BookProgress\";\nimport BookSidebar from \"./BookSidebar\";\nimport ReadingMenuBar from \"./ReadingMenuBar\";\nimport ChapterHeader from \"./ChapterHeader\";\nimport StaleURLMessage from \"./StaleURLMessage\";\nimport WarningMessages from \"./WarningMessages\";\nimport { MODE_LOADING, MODE_ERROR, MODE_DONE, MODE_NOT_READY } from \"../Constants\";\n\n/**\n * Below are some notes about how this works:\n *   * useState() will trigger the fetch of the work as necessary when the URL changes.\n *   * loadChapter() will fetch the chapter and load it into the UI.\n */\nconst PARALLEL_WORK_PREFIX = 'secondWork-';\n\nconst ContainerStyle = {\n  paddingTop: 0,\n};\n\nconst SidebarStyle = {\n  height: \"calc(100vh - 60px)\",\n  marginTop: 0,\n};\n\nconst getWordFormsDebounced = AwesomeDebouncePromise(\n  (word) =>\n  fetch(ENDPOINT_WORD_FORMS(word)),\n  500\n);\n\n/**\n * Scroll to the given verse\n *\n * @param {string} verse The number of the verse to scroll to.\n */\nconst scrollToVerse = (verse) => {\n  // Scroll to the verse\n  if(verse) {\n    scrollToTarget(`verse-link_${verse}`);\n  }\n}\n\n/**\n * Get the parameter of the second work to be loaded.\n */\nconst getSecondWorkParameter = (location) => {\n  const params = new URLSearchParams(location.search);\n  return params.get('parallel');\n}\n\n/**\n * Go to the search page.\n */\nconst openSearch = (loadedWork, secondWork, divisions, history) => {\n  let q = `work:${loadedWork}`;\n\n  // Add the second work\n  if (secondWork) {\n    q += ` OR work:${secondWork}`;\n  }\n\n  // Add in the section\n  if (divisions && divisions.length > 0) {\n    q += ` section:${divisions[0]}`;\n  }\n\n  history.push(SEARCH(q), {\n    work: loadedWork,\n    secondWork,\n    divisions,\n  });\n}\n\nconst Reader = ({\n  inverted,\n  location,\n  history,\n  match,\n  highlightRelatedForms\n}) => {\n\n  const [modal, setModal] = useState(null);\n  const [data, setData] = useState(null);\n  const [errorDescription, setErrorDescription] = useState(null);\n  const [loading, setLoading] = useState(null);\n  const [divisions, setDivisions] = useState(null);\n  const [referenceValue, setReferenceValue] = useState(null);\n\n  const [bookSelectionOpen, setBookSelectionOpen] = useState(null);\n  const [errorTitle, setErrorTitle] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [redirectedFrom, setRedirectedFrom] = useState(null);\n  const [redirectedTo, setRedirectedTo] = useState(null);\n  const [sidebarVisible, setSidebarVisible] = useState(false);\n\n  const [loadedWork, setLoadedWork] = useState(null);\n  const [highlightedVerse, setHighlightedVerse] = useState(null);\n  const [highlightedWords, setHighlightedWords] = useState([]);\n  const [selectedWord, setSelectedWord] = useState(null);\n  const [popupX, setPopupX] = useState(null);\n  const [popupY, setPopupY] = useState(null);\n\n  const [popupPositionRight, setPopupPositionRight] = useState(null);\n  const [popupPositionBelow, setPopupPositionBelow] = useState(null);\n  const [popupWork, setPopupWork] = useState(null);\n  const [selectedNote, setSelectedNote] = useState(null);\n  const [secondWork, setSecondWork] = useState(null);\n  const [secondWorkData, setSecondWorkData] = useState(null);\n  const [secondWorkChapterNotFound, setSecondWorkChapterNotFound] = useState(false);\n  const [secondWorkTitle, setSecondWorkTitle] = useState(null);\n  const [fontSizeAdjustment, setFontSizeAdjustment] = useState(getFontAdjustment());\n\n  const verseReferences = useRef([]);\n\n  /**\n   * Set an error state.\n   *\n   * @param {string} errorTitle The title\n   * @param {string} errorDescription The description\n   * @param {string} errorMessage The detailed error message (like from an AJAX call)\n   */\n  const setErrorState = (errTitle, errDescription = \"\", errMessage = null) => {\n    setErrorMessage(errMessage);\n    setErrorDescription(errDescription);\n    setErrorTitle(errTitle);\n  }\n\n  /**\n   * Increase the font size\n   */\n  const increaseFontSize = () => {\n    if(fontSizeAdjustment < MAX_FONT_SIZE_ADJUSTMENT) {\n      setFontAdjustment(fontSizeAdjustment + 1);\n      setFontSizeAdjustment(fontSizeAdjustment + 1);\n    }\n  }\n\n  /**\n   * Decrease the font size\n   */\n  const decreaseFontSize = () => {\n    if(fontSizeAdjustment > 0) {\n      setFontAdjustment(fontSizeAdjustment - 1);\n      setFontSizeAdjustment(fontSizeAdjustment - 1);\n    }\n  }\n\n  /**\n   * Load the given chapter.\n   *\n   * @param {string} work The title slug of the work\n   * @param {array} divisions The list of division indicators\n   */\n  const loadSecondWorkChapter = (work, ...secondDivisions) => {\n    // Load the start page if there is no work to load\n    if (!work) {\n      return;\n    }\n\n    // Reset the state to show that we are loading\n    setSecondWork(work);\n    setSecondWorkData(null);\n    setSecondWorkTitle(null);\n\n    fetch(ENDPOINT_READ_WORK(work, ...secondDivisions))\n      .then((res) => Promise.all([res.status, res.json()]))\n      .then(([status, newData]) => {\n        if (status >= 200 && status < 300) {\n          setSecondWork(work);\n          setSecondWorkData(newData);\n          setSecondWorkTitle(newData.work.title);\n\n          if(status === 210) {\n            setSecondWorkChapterNotFound(true);\n          } else {\n            setSecondWorkChapterNotFound(false);\n          }\n\n          // Rescroll to keep the verse in the view\n          if(highlightedVerse) {\n            scrollToVerse(highlightedVerse);\n          }\n\n          // Remember that we read this work\n          setWorkProgress(work, secondDivisions, newData.reference_descriptor);\n\n        } else {\n          setErrorState(\n            \"Work could not be found\",\n            \"Yikes. The given work is not recognized as a valid work.\"\n          );\n        }\n      })\n      .catch((e) => {\n        setErrorState(\n          \"Unable to load the content\",\n          \"The given chapter could not be loaded from the server\",\n          e.toString()\n        );\n      });\n  }\n\n  /**\n   * Update the history but only if it has changed.\n   *\n   * @param {str} work The title slug of the work\n   * @param {str} secondWork The title slug of the second work to load work\n   * @param  {...any} divisions The list of division indicators\n   */\n  const updateHistory = (work, newSecondWork, ...newDivisions) => {\n\n    const parallelWork = getSecondWorkParameter(location);\n\n    // Get the URL\n    const workUrl = READ_WORK(work, null, ...newDivisions);\n\n    // Determine if the URL is already set\n    // Note that we need to check redirectedFrom because the URL might not match because we were\n    // redirected since a work had been renamed.\n    if (workUrl === location.pathname && parallelWork === newSecondWork) {\n      return false;\n    }\n\n    // Add the parallel work\n    if (newSecondWork) {\n      history.push({\n        pathname: workUrl,\n        search: PARAMS_READ_WORK(newSecondWork)\n      })\n    } else {\n      history.push(workUrl);\n    }\n\n    return true;\n  }\n\n  /**\n   * Navigate to chapter.\n   *\n   * @param {string} work The title slug of the work\n   * @param {string} parallelWork The title slug of the parallel work\n   * @param {array} divisions The list of division indicators\n   */\n  const navigateToChapter = (work, parallelWork, ...newDivisions) => {\n    updateHistory(work, parallelWork, ...newDivisions);\n  }\n\n  /**\n   * Go to the reference defined in the input box.\n   */\n  const goToReference = (requestedWork, newReferenceValue, referenceInfo) => {\n\n    // Stop if we have no where to go\n    if (!requestedWork || !referenceValue) {\n      return;\n    }\n\n    setDivisions(referenceInfo.divisions);\n    scrollToVerse(referenceInfo.verse_to_highlight);\n    setHighlightedVerse(referenceInfo.verse_to_highlight);\n    setReferenceValue(newReferenceValue);\n\n    navigateToChapter(requestedWork, secondWork, ...referenceInfo.divisions);\n  }\n\n  /**\n   * Close the second work\n   */\n  const closeSecondWork = () => {\n    setSecondWork(null);\n    setSecondWorkData(null);\n\n    if(divisions) {\n      updateHistory(loadedWork, null, ...divisions);\n    }\n    else {\n      updateHistory(loadedWork);\n    }\n  }\n\n  /**\n   * Handle the selection of a work.\n   * @param {string} work the title slug of a work to load\n   */\n  const onSelectWork = (work) => {\n    let isRelated = false;\n\n    // See if this is a related work\n    if (data && data.related_works) {\n      isRelated = data.related_works.find(\n        (relatedWork) => relatedWork.title_slug === work\n      );\n    }\n\n    // If this is related work, then use the same divisions\n    if (isRelated && work !== loadedWork) {\n      setBookSelectionOpen(false);\n      loadSecondWorkChapter(work, ...divisions);\n\n      history.push({\n        pathname: location.pathname,\n        search: PARAMS_READ_WORK(work)\n      })\n    } else {\n      // Drop the second work since this one is not related\n      closeSecondWork();\n      navigateToChapter(work);  \n    }\n  }\n\n  /**\n   * Add the href to the list so that we can remember what URL is capable of loading it.\n   * @param {string} href The partial URL of the page (e.g. \"/work/new-testament/John/8/4\")\n   * @param {string} chapter The chapter descriptor (e.g. \"John/9\")\n   */\n  const addVerseToHistoryList = (href, chapter, verse, newReferenceValue) => {\n    verseReferences.current[href] = {\n      chapter,\n      verse,\n      newReferenceValue,\n    };\n  }\n\n  /**\n   * Handle the clicking of a verse.\n   *\n   * @param {string} verseDescriptor A description of the verse (e.g. \"John 8:4\")\n   * @param {string} verse The verse number (e.g. \"4\")\n   * @param {string} id An ID that designates the verse in the HTML DOM\n   * @param {string} href A href for the verse (e.g. \"/work/new-testament/John/8/4\")\n   */\n  const onVerseClick = (verseDescriptor, verse, id, href) => {\n    // Add the verse to the list\n    addVerseToHistoryList(\n      href,\n      data.chapter.full_descriptor,\n      verse,\n      verseDescriptor\n    );\n\n    scrollToTarget(id);\n\n    setReferenceValue(verseDescriptor);\n    \n    // Add the parallel work\n    if (secondWork) {\n      history.push(`${href}${PARAMS_READ_WORK(secondWork)}`);\n    } else {\n      history.push(href);\n    }\n  }\n\n  /**\n   * Handle the clicking of a verse of a second work.\n   *\n   * @param {string} verseDescriptor A description of the verse (e.g. \"John 8:4\")\n   * @param {string} verse The verse number (e.g. \"4\")\n   * @param {string} id An ID that designates the verse in the HTML DOM\n   */\n  const onVerseClickSecondWork = (verseDescriptor, verse, id) => {\n    const firstWorkId = id.substr(PARALLEL_WORK_PREFIX.length);\n\n    // Find the verse descriptor from the first work\n    const firstWorkVerse = document.getElementById(firstWorkId);\n\n    // Fire the associated handler\n    // This may not match for works that have more verses in the parallel work than the primary one\n    if(firstWorkVerse) {\n      onVerseClick(verseDescriptor, verse, id, firstWorkVerse.attributes.href.value);\n    }\n  }\n\n  /**\n   * Go to the next chapter.\n   */\n  const goToNextChapter = () => {\n    if (data && data.next_chapter) {\n      navigateToChapter(loadedWork, secondWork, data.next_chapter.full_descriptor);\n    }\n  }\n\n  /**\n   * Go to the prior chapter.\n   */\n  const goToPriorChapter = () => {\n    if (data && data.previous_chapter) {\n      navigateToChapter(loadedWork, secondWork, data.previous_chapter.full_descriptor);\n    }\n  }\n\n  /**\n   * Handle the selection of the division.\n   *\n   * @param {*} event React's original SyntheticEvent.\n   * @param {*} info All props.\n   */\n  const changeChapter = (event, info) => {\n    navigateToChapter(loadedWork, secondWork, info.value);\n  }\n\n  /**\n   * Handle the clicking of a word.\n   *\n   * @param {string} word The word to get information on\n   * @param {int} x The x coordinate designating where to show the popup\n   * @param {int} y The y coordinate designating where to show the popup\n   * @param {bool} positionRight Indicates it is best to show the popup to the right of the offset\n   * @param {bool} positionBelow Indicates it is best to show the popup below the offset\n   * @param {string} work Indicates the work clicked\n   */\n  const onWordClick = (word, x, y, positionRight, positionBelow, work) => {\n    setSelectedWord(word);\n    setPopupX(x);\n    setPopupY(y);\n    setPopupPositionRight(positionRight);\n    setPopupPositionBelow(positionBelow);\n    setPopupWork(work);\n    setModal(MODAL_WORD);\n  }\n\n  /**\n   * Handle the clicking of a note.\n   *\n   * @param {string} note The note's contents\n   * @param {string} id The ID of the note\n   * @param {int} x The x coordinate designating where to show the popup\n   * @param {int} y The y coordinate designating where to show the popup\n   * @param {bool} positionRight Indicates it is best to show the popup to the right of the offset\n   * @param {bool} positionBelow Indicates it is best to show the popup below the offset\n   */\n  const onNoteClick = (note, id, x, y, positionRight, positionBelow) => {\n    setSelectedNote(note);\n    setPopupX(x);\n    setPopupY(y);\n    setPopupPositionRight(positionRight);\n    setPopupPositionBelow(positionBelow);\n    setModal(MODAL_FOOTNOTE);\n  }\n\n  /**\n   * Load the given chapter.\n   *\n   * @param {string} work The title slug of the work\n   * @param {array} divisions The list of division indicators\n   */\n  const loadChapter = (work, ...newDivisions) => {\n    // Load the start page if there is no work to load\n    if (!work) {\n      setBookSelectionOpen(false);\n      setModal(null);\n      setErrorTitle(null);\n      setErrorMessage(null);\n      setErrorDescription(null);\n      setRedirectedFrom(null);\n      setRedirectedTo(null);\n      setHighlightedVerse(null);\n      setData(null);\n      setLoading(null);\n      setLoadedWork(null);\n      setDivisions(null);\n      setReferenceValue(null);\n\n      return;\n    }\n\n    // Reset the state to show that we are loading\n    setLoading(true);\n    setBookSelectionOpen(false);\n    setModal(null);\n    setErrorTitle(null);\n    setErrorMessage(null);\n    setErrorDescription(null);\n    setRedirectedFrom(null);\n    setRedirectedTo(null);\n    setHighlightedVerse(null);\n\n    // Load the second work if necessary\n    if (secondWork) {\n      loadSecondWorkChapter(secondWork, ...newDivisions);\n    }\n\n    // Load the work\n    fetch(ENDPOINT_READ_WORK(work, ...newDivisions))\n      .then((res) => Promise.all([res.status, res.json()]))\n      .then(([status, updatedData]) => {\n        if (status >= 200 && status < 300) {\n          let newRedirectedFrom = null;\n          let newRedirectedTo = null;\n\n          // If the work alias didn't match, then update the URL accordingly\n          if (updatedData.work.title_slug !== work) {\n            newRedirectedFrom = READ_WORK(work, null, ...newDivisions);\n            newRedirectedTo = READ_WORK(updatedData.work.title_slug, null, ...newDivisions);\n          }\n\n          setLoadedWork(updatedData.work.title_slug);\n          setDivisions(newDivisions);\n          setReferenceValue(updatedData.reference_descriptor);\n          setRedirectedFrom(newRedirectedFrom);\n          setRedirectedTo(newRedirectedTo);\n          setHighlightedVerse(updatedData.verse_to_highlight);\n          setData(updatedData);\n          setLoading(false);\n\n          // Remember that we read this work\n          setWorkProgress(work, newDivisions, updatedData.reference_descriptor);\n\n          // Add the verse to the list\n          addVerseToHistoryList(\n            READ_WORK(work, ...newDivisions),\n            updatedData.chapter.full_descriptor,\n            updatedData.verse_to_highlight,\n            updatedData.chapter.description\n          );\n\n          // Scroll to the verse\n          scrollToVerse(updatedData.verse_to_highlight);\n\n          // Update the URL if we were redirected\n          if (redirectedFrom) {\n            updateHistory(updatedData.work.title_slug, secondWork, ...newDivisions);\n          }\n        } else {\n          setErrorState(\n            \"Work could not be found\",\n            \"Yikes. The given work is not recognized as a valid work.\"\n          );\n        }\n      })\n      .catch((e) => {\n        setErrorState(\n          \"Unable to load the content\",\n          \"The given chapter could not be loaded from the server\",\n          e.toString()\n        );\n      });\n  }\n\n  const onWordHover = word => {\n    if(highlightRelatedForms) {\n      getWordFormsDebounced(word)\n      .then((res) => res.json())\n      .then(wordData => {\n        if(wordData.forms.length > 1){\n          // Add in the word we searched for just in case\n          const wordsList = wordData.forms.slice();\n          wordsList.splice(0, 0, word);\n\n          // Light them up\n          setHighlightedWords(wordsList);\n        }\n        \n      });\n    }\n\n    setHighlightedWords([word])\n  }\n\n  const previousPathname = useRef();\n\n  useEffect(() => {\n    // Get the divisions from the URL\n    const divisionsFiltered = [\n      match.params.division0,\n      match.params.division1,\n      match.params.division2,\n      match.params.division3,\n      match.params.division4,\n      match.params.leftovers,\n    ].filter((entry) => entry);\n\n    // See if we have loaded the same work\n    const sameSecondWork = secondWork === getSecondWorkParameter(location);\n\n    // See if we know that this is a reference to this chapter\n    const existingChapter = verseReferences.current[location.pathname];\n\n    // Check if the chapter we have loaded already\n    // This needs to check the loaded work too, since we need to recognize if we the reference is\n    // the same reference but in a different work.\n    const isReferenceForSameChapter = data &&\n      data.chapter &&\n      existingChapter &&\n      existingChapter.chapter === data.chapter.full_descriptor &&\n      loadedWork &&\n      loadedWork === match.params.work;\n\n    // Check if the chapter we have loaded already\n    // This needs to check the loaded work too, since we need to recognize if we the reference is\n    // the same reference but in a different work.\n    if (isReferenceForSameChapter && sameSecondWork) {\n      // Get the highlighted verse\n      const highlightedVerseRef = existingChapter.verse;\n\n      if (highlightedVerse !== highlightedVerseRef) {\n        if(highlightedVerseRef) {\n          setHighlightedVerse(highlightedVerseRef);\n        }\n        \n        if(!referenceValue){\n          setReferenceValue(existingChapter.referenceValue);\n        }\n      }\n\n      // Don't load the new one, we already have it on the page\n      return;\n    }\n\n    // Determine if the page changed\n    if (\n      (location.pathname !== previousPathname.current &&\n      redirectedTo !== location.pathname)\n    ) {\n      loadChapter(match.params.work, ...divisionsFiltered);\n      previousPathname.current = location.pathname;\n      return;\n    }\n\n    previousPathname.current = location.pathname;\n\n    // Try to get the second work\n    if (!sameSecondWork) {\n      if(getSecondWorkParameter(location)) {\n        loadSecondWorkChapter(getSecondWorkParameter(location), ...divisionsFiltered);\n      }\n      else {\n        setSecondWork(null);\n        setSecondWorkData(null);\n      }\n    }\n  });\n\n  // Figure out a description for the chapter\n  let description = \"\";\n  let referenceDescription = referenceValue;\n\n  if (data) {\n    description = data.chapter.description;\n\n    if (referenceValue === \"\") {\n      referenceDescription = description;\n    }\n  }\n\n  // Create a custom className for signaling the desire to switch to inverted\n  let classNameSuffix = \"\";\n\n  if (inverted) {\n    classNameSuffix = \" inverted\";\n  }\n\n  // Determine what we ought to be rendering\n  let mode = MODE_LOADING;\n\n  if (data && !loading) {\n    mode = MODE_DONE;\n  } else if (errorTitle) {\n    mode = MODE_ERROR;\n  } else if (match.params && match.params.work && !data) {\n    mode = MODE_LOADING;\n  } else if (loading && !errorTitle) {\n    mode = MODE_LOADING;\n  } else {\n    mode = MODE_NOT_READY;\n  }\n\n  // Get the list of related works so that the book selector can put the related ones at the top\n  const relatedWorks = data && data.related_works ? data.related_works : [];\n  const authors =\n    data && data.authors ? data.authors.map((author) => author.name) : null;\n\n  return (\n    <>\n      <div\n        className=\"buffer\"\n        style={{\n          height: 54,\n          width: \"100%\",\n        }}\n      />\n      <ReadingMenuBar\n        inverted={inverted}\n        relatedWorks={relatedWorks}\n        authors={authors}\n        loadedWork={loadedWork}\n        toggleSidebarVisible={() => setSidebarVisible(!sidebarVisible)}\n        onSelectWork={(work) => onSelectWork(work)}\n        setBookSelectionOpen={(b) => setBookSelectionOpen(b)}\n        bookSelectionOpen={bookSelectionOpen}\n        goToReference={(newWork, newReferenceValue, referenceInfo) =>\n          goToReference(newWork, newReferenceValue, referenceInfo)}\n        openAboutModal={() => setModal(\"about\")}\n        goToPriorChapter={loading ? null : () => goToPriorChapter()}\n        goToNextChapter={loading ? null : () => goToNextChapter()}\n        referenceValue={referenceDescription}\n        hasNextChapter={!loading && data && data.next_chapter !== null}\n        hasPriorChapter={!loading && data && data.previous_chapter !== null}\n        nextChapterDescriptor={\n          data && data.previous_chapter && data.previous_chapter.full_descriptor\n        }\n        previousChapterDescriptor={\n          data && data.next_chapter && data.next_chapter.full_descriptor\n        }\n        decreaseFontSize={!loading && data ? () => decreaseFontSize() : null}\n        increaseFontSize={!loading && data ? () => increaseFontSize() : null}\n        increaseFontSizeDisabled={\n          fontSizeAdjustment >= MAX_FONT_SIZE_ADJUSTMENT\n        }\n        decreaseFontSizeDisabled={fontSizeAdjustment <= 0}\n      />\n      {mode === MODE_DONE && (\n        <>\n          <BookSidebar\n            sidebarVisible={sidebarVisible}\n            work={loadedWork}\n            openWorkInfoModal={() => setModal(\"aboutWork\")}\n            openDownloadModal={() => setModal(\"downloadWork\")}\n            openSearch={() =>\n              openSearch(loadedWork, secondWork, divisions, history)}\n            setSidebarVisible={() => setSidebarVisible()}\n          />\n          <Sidebar.Pushable\n            as={Segment}\n            basic\n            style={SidebarStyle}\n            className={`${classNameSuffix}`}\n          >\n            <Sidebar.Pusher>\n              <Container className={`underMenu ${classNameSuffix}`}>\n                {getDialogs(modal, data, loading, loadedWork, () =>\n                  setModal(null)\n                )}\n                {getPopups(\n                  modal,\n                  data,\n                  loading,\n                  selectedWord,\n                  popupX,\n                  popupY,\n                  popupPositionRight,\n                  popupPositionBelow,\n                  selectedNote,\n                  popupWork,\n                  () => setModal(null),\n                  {\n                    work: loadedWork,\n                    secondWork,\n                    divisions,\n                  },\n                  inverted\n                )}\n                <Grid inverted={inverted}>\n                  <Grid.Row>\n                    <Grid.Column width={8}>\n                      <ChapterHeader\n                        inverted={inverted}\n                        data={data}\n                        onChangeChapter={(event, info) => changeChapter(event, info)}\n                      />\n                    </Grid.Column>\n                    <Grid.Column width={8}>\n                      <Container textAlign=\"right\">\n                        <Header inverted={inverted} floated=\"right\" as=\"h3\">\n                          {data.work.title}\n                          {secondWork && secondWorkTitle && (\n                            <>\n                              {\" / \"}\n                              {secondWorkTitle}\n                              <Icon\n                                title={`Close ${secondWorkTitle}`}\n                                size=\"mini\"\n                                style={{\n                                  cursor: \"pointer\",\n                                  fontSize: 13,\n                                  paddingLeft: 8,\n                                }}\n                                inverted={inverted}\n                                name=\"close\"\n                                onClick={() => closeSecondWork()}\n                              />\n                            </>\n                          )}\n                        </Header>\n                      </Container>\n                    </Grid.Column>\n                  </Grid.Row>\n                </Grid>\n                <div style={{ marginTop: 6 }} />\n                {data && <WarningMessages warnings={data.warnings} />}\n                {redirectedFrom && <StaleURLMessage inverted={inverted} />}\n                <BookProgress data={data} />\n\n                {!secondWork && (\n                  <Chapter\n                    chapter={data.chapter}\n                    content={data.content}\n                    work={data.work}\n                    onVerseClick={onVerseClick}\n                    onWordClick={(word, x, y, positionRight, positionBelow) => {\n                      onWordClick(\n                        word,\n                        x,\n                        y,\n                        positionRight,\n                        positionBelow,\n                        loadedWork\n                      );\n                    }}\n                    onNoteClick={onNoteClick}\n                    onClickAway={() => setModal(null)}\n                    highlightedVerse={highlightedVerse}\n                    inverted={inverted}\n                    fontSizeAdjustment={fontSizeAdjustment}\n                    highlightedWords={highlightedWords}\n                    onWordHover={(word) => {\n                      onWordHover(word);\n                    }}\n                  />\n                )}\n\n                {secondWork && (\n                  <Grid divided=\"vertically\">\n                    <Grid.Row columns={2}>\n                      <Grid.Column>\n                        <Chapter\n                          chapter={data.chapter}\n                          content={data.content}\n                          work={data.work}\n                          onVerseClick={onVerseClick}\n                          onWordClick={(\n                            word,\n                            x,\n                            y,\n                            positionRight,\n                            positionBelow\n                          ) => {\n                            onWordClick(\n                              word,\n                              x,\n                              y,\n                              positionRight,\n                              positionBelow,\n                              loadedWork\n                            );\n                          }}\n                          onNoteClick={onNoteClick}\n                          onClickAway={() => setModal(null)}\n                          highlightedVerse={highlightedVerse}\n                          inverted={inverted}\n                          fontSizeAdjustment={fontSizeAdjustment}\n                          highlightedWords={highlightedWords}\n                          onWordHover={(word) => {\n                            onWordHover(word);\n                          }}\n                        />\n                      </Grid.Column>\n                      <Grid.Column>\n                        {secondWorkData && !secondWorkChapterNotFound && (\n                          <Chapter\n                            chapter={secondWorkData.chapter}\n                            content={secondWorkData.content}\n                            work={secondWorkData.work}\n                            onVerseClick={(verseDescriptor, verse, id, href) =>\n                              onVerseClickSecondWork(\n                                verseDescriptor,\n                                verse,\n                                id,\n                                href\n                              )}\n                            onWordClick={(\n                              word,\n                              x,\n                              y,\n                              positionRight,\n                              positionBelow\n                            ) => {\n                              onWordClick(\n                                word,\n                                x,\n                                y,\n                                positionRight,\n                                positionBelow,\n                                secondWork\n                              );\n                            }}\n                            onNoteClick={onNoteClick}\n                            onClickAway={() => setModal(null)}\n                            highlightedVerse={highlightedVerse}\n                            inverted={inverted}\n                            verseIdentifierPrefix={PARALLEL_WORK_PREFIX}\n                            fontSizeAdjustment={fontSizeAdjustment}\n                            highlightedWords={highlightedWords}\n                            onWordHover={(word) => {\n                              onWordHover(word);\n                            }}\n                          />\n                        )}\n                        {secondWorkData && secondWorkChapterNotFound && (\n                          <WarningMessages\n                            inverted={inverted}\n                            warnings={[\n                              [\n                                \"Chapter not found\",\n                                `The given chapter does not exist in ${secondWorkTitle}`,\n                              ],\n                            ]}\n                          />\n                        )}\n                        {!secondWorkData &&\n                          !secondWorkChapterNotFound &&\n                          getPlaceholder(inverted)}\n                      </Grid.Column>\n                    </Grid.Row>\n                  </Grid>\n                )}\n              </Container>\n            </Sidebar.Pusher>\n          </Sidebar.Pushable>\n        </>\n      )}\n      {mode === MODE_ERROR && (\n        <Container style={ContainerStyle} className={`${classNameSuffix}`}>\n          <ErrorMessage\n            inverted={inverted}\n            title={errorTitle}\n            description={errorDescription}\n            message={errorMessage}\n          />\n        </Container>\n      )}\n      {mode === MODE_LOADING && (\n        <Container style={ContainerStyle} className={`${classNameSuffix}`}>\n          {getPlaceholder(inverted)}\n        </Container>\n      )}\n      {mode === MODE_NOT_READY && (\n        <Container style={ContainerStyle} className={`${classNameSuffix}`}>\n          <div style={{ paddingTop: 24 }}>\n            <NoWorkSelected\n              onClick={() => setBookSelectionOpen(true)}\n              inverted={inverted}\n            />\n            <FavoriteWorks inverted={inverted} />\n          </div>\n        </Container>\n      )}\n      {modal === \"about\" && <AboutDialog onClose={() => setModal(null)} />}\n    </>\n  );\n\n}\n\nReader.propTypes = {\n  inverted: PropTypes.bool,\n  // eslint-disable-next-line react/forbid-prop-types\n  location: PropTypes.object.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  match: PropTypes.object.isRequired,\n  highlightRelatedForms: PropTypes.bool,\n};\n\nReader.defaultProps = {\n  inverted: false,\n  highlightRelatedForms: true,\n};\n\nexport default withRouter(Reader);","import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport Reader from './components/Reader';\n\nconst App = ({ inverted }) => (\n  <Reader\n    inverted={inverted}\n  />\n)\n\nApp.propTypes = {\n  inverted: PropTypes.bool,\n};\n\nApp.defaultProps = {\n  inverted: false,\n};\n\nexport default withRouter(App);\n"],"sourceRoot":""}